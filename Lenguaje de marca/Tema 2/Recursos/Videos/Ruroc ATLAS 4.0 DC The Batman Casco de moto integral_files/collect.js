window.NOIBUJS_CONFIG={"scriptID":"1.0.15","sel":[".box-content",".shipping-address-items",".shipping-address-item"],"nid_cookie":false,"njs_version":"stable"};(()=>{var e={746:(e,t,n)=>{"use strict";n.d(t,{T:()=>r}),e=n.hmd(e);var r=null;try{var i="function"==typeof e.require&&n(Object(function(){var e=new Error("Cannot find module 'worker_threads'");throw e.code="MODULE_NOT_FOUND",e}()))||"function"==typeof require&&require("worker_threads")||n(Object(function(){var e=new Error("Cannot find module 'worker_threads'");throw e.code="MODULE_NOT_FOUND",e}()));r=i.Worker}catch(e){}},327:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},217:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},171:(e,t,n)=>{var r=n(217),i=n(327);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r](o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=["metroplexSocketBase","metroplexHTTPBase"],t=["innerText","textContent","value","title"],r=["Image","EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];function i(){return window.NOIBUJS_CONFIG?window.NOIBUJS_CONFIG:{}}const o=["i.noibu","i.staging.noibu","input.staging.noibu","input.b.noibu","input.noibu","vf.staging.noibu","vf.noibu"],a=["error","warn","log"],s=["pagehide","pageshow","focus","blur","popstate","online","offline","messageerror","languagechange","hashchange","beforeprint","afterprint","load","resize"],c=["visibilitychange","resume","freeze","readystatechange","cut","copy","paste"],u=new Set(["--quantum-metric-background-image","--quantum-metric-background-position-x","--quantum-metric-background-position-y","--quantum-metric-background-size","--quantum-metric-background-attachment","--quantum-metric-background-origin","--quantum-metric-background-clip","--quantum-metric-background-color","--quantum-metric-border-image-source","--quantum-metric-border-image-slice","--quantum-metric-border-image-width","--quantum-metric-border-image-outset","--quantum-metric-border-image-repeat","--quantum-metric-border-top-style","--quantum-metric-border-right-style","--quantum-metric-border-bottom-style","--quantum-metric-border-left-style","--quantum-metric-border-top-color","--quantum-metric-border-right-color","--quantum-metric-border-bottom-color","--quantum-metric-border-left-color","--quantum-metric-border-top-width","--quantum-metric-border-right-width","--quantum-metric-border-bottom-width","--quantum-metric-border-left-width","--quantum-metric-flex-wrap","--quantum-metric-list-style-image","--quantum-metric-list-style-position","--quantum-metric-max-width","--quantum-metric-outline-color","--quantum-metric-outline-style","--quantum-metric-outline-width"]);function l(){const e=i();return e.scriptID?e.scriptID:"default"}function d(){const e=i();return!!e.njs_version&&"beta"===e.njs_version}function g(){try{const e=d()?"wss://input.b.noibu.com":"wss://input.noibu.com";return e.endsWith("/")?e.slice(0,-1):e}catch(e){return"ws://localhost:3000"}}function p(){try{const e=d()?"https://input.b.noibu.com":"https://input.noibu.com";return e.endsWith("/")?e.slice(0,-1):e}catch(e){return"http://localhost:3000"}}function h(){return p()+"/pv"}function m(){try{return"prod"}catch(e){return"test"}}const f=/("href":["']([^"]*\.css[^"]*)["'])/gi;var I=n(171),C=n.n(I);const v=(e,t,n)=>{if(!(t in e))return;const r=e[t],i=n(r);if("function"==typeof i)try{i.prototype=i.prototype||{},Object.defineProperties(i,{__noibu__:{enumerable:!1,value:!0},__noibu_original__:{enumerable:!1,value:r},__noibu_wrapped__:{enumerable:!1,value:i}})}catch(e){}e[t]=i};function A(e){return e.split("\n").reduce((function(e,t){var n=function(e){var t=y.exec(e);if(!t)return null;var n=t[2]&&0===t[2].indexOf("native"),r=t[2]&&0===t[2].indexOf("eval"),i=b.exec(t[2]);r&&null!=i&&(t[2]=i[1],t[3]=i[2],t[4]=i[3]);return{file:n?null:t[2],methodName:t[1]||"<unknown>",arguments:n?[t[2]]:[],lineNumber:t[3]?+t[3]:null,column:t[4]?+t[4]:null}}(t)||function(e){var t=S.exec(e);if(!t)return null;return{file:t[2],methodName:t[1]||"<unknown>",arguments:[],lineNumber:+t[3],column:t[4]?+t[4]:null}}(t)||function(e){var t=w.exec(e);if(!t)return null;var n=t[3]&&t[3].indexOf(" > eval")>-1,r=k.exec(t[3]);n&&null!=r&&(t[3]=r[1],t[4]=r[2],t[5]=null);return{file:t[3],methodName:t[1]||"<unknown>",arguments:t[2]?t[2].split(","):[],lineNumber:t[4]?+t[4]:null,column:t[5]?+t[5]:null}}(t)||function(e){var t=N.exec(e);if(!t)return null;return{file:t[2],methodName:t[1]||"<unknown>",arguments:[],lineNumber:+t[3],column:t[4]?+t[4]:null}}(t)||function(e){var t=E.exec(e);if(!t)return null;return{file:t[3],methodName:t[1]||"<unknown>",arguments:[],lineNumber:+t[4],column:t[5]?+t[5]:null}}(t);return n&&e.push(n),e}),[])}var y=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/|[a-z]:\\|\\\\).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,b=/\((\S*)(?::(\d+))(?::(\d+))\)/;var S=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;var w=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,k=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;var E=/^\s*(?:([^@]*)(?:\((.*?)\))?@)?(\S.*?):(\d+)(?::(\d+))?\s*$/i;var N=/^\s*at (?:((?:\[object object\])?[^\\/]+(?: \[as \S+\])?) )?\(?(.*?):(\d+)(?::(\d+))?\)?\s*$/i;function _(e,t=1024){return e?e.length<t?e:e.substring(0,t):e}function R(){let e=window.location.href;return window.location.href.startsWith("http")?e=window.location.href:window.parent&&window.parent.location&&window.parent.location.href.startsWith("http")&&(e=window.parent.location.href),_(e)}function T(e){let t=[{line:"_",mname:"_",file:"_"}];if("object"!=typeof e||!e)return{frames:t,msg:""};e.stack?t=A(e.stack).map(e=>{const t={line:"_",mname:"_",file:"_"};return e.lineNumber&&"<unknown>"!==e.lineNumber&&(t.line=String(e.lineNumber)),e.methodName&&"<unknown>"!==e.methodName&&(t.mname=String(e.methodName)),e.file&&"<unknown>"!==e.file&&(t.file=String(e.file)),e.column&&"number"==typeof e.column&&(t.column=e.column),t}):(e.fileName&&"string"==typeof e.fileName&&(t[0].file=e.fileName),e.lineNumber&&(t[0].line=String(e.lineNumber)),e.columnNumber&&Number.isInteger(e.columnNumber)&&(t[0].column=e.columnNumber)),t.length>=50&&(t=t.slice(0,50));return{frames:t,msg:e.message?_(e.message):""}}function M(e){if(Array.prototype.toJSON){const t=Array.prototype.toJSON;delete Array.prototype.toJSON;const n=JSON.stringify(e);return Array.prototype.toJSON=t,n}return JSON.stringify(e)}function D(e,t,n,r,i,o){if(o){const e=M(n),i=new Blob([e]).size;return!window.fetch||i>59e3?new Promise(e=>{e()}):fetch(t,{method:"POST",headers:r,body:M(n),keepalive:!0})}return new Promise((o,a)=>{const s=new XMLHttpRequest;s.open(e,t),s.timeout=i,Object.keys(r).forEach(e=>{s.setRequestHeader(e,r[e])}),s.onload=()=>{s.status>=200&&s.status<300?o(s.response):a(new Error("Custom Request failed: "+s.statusText))},s.onerror=()=>{a(new Error("Custom Request failed: "+s.statusText))},n?s.send(M(n)):s.send()})}function O(){const e=i();return e.sel&&Array.isArray(e.sel)}function L(){const e=i();return!!function(){const e=i();return"undefined"!==e.nid_cookie&&null!=e.nid_cookie}()&&e.nid_cookie}function x(){const e=i(),t=[".noibu-blocked",".creditCard"];return O()&&t.push(...e.sel),""+t.join(",")}function V(){const e="1"===window.navigator.doNotTrack,t=function(e){let t=e;return t||(t=window.navigator.userAgent),t=t.toLowerCase(),new RegExp("(bot|crawl(er)?|sp(i|y)der|search|worm|fetch|nutch|headless|baidu|teoma|yandex|woorankreview|pingdom|synthetic|dataprovider|qaautomation|morningscore|wappalyzer|foregenix|StatusCake|SpeedCurve|Outlook-iOS|bitdiscovery|testing|webflow|bingpreview|(r|R)igor|facebookexternalhit/\\d+\\.\\d+)","i").test(t)}(null);return e||t}function B(e){return e?"object"==typeof e?M(e):String(e):""}function F(e){let t=_(window.location.href);return e&&""!==e.trim()&&"undefined"!==e&&(t=B(_(e))),t}const P={"input.noibu.com":!0,"input.staging.noibu.com":!0,"vf.noibu.com":!0,"vf.staging.noibu.com":!0,"cdn.noibu.com":!0};function G(e){return window&&window.localStorage&&navigator.cookieEnabled?window.localStorage.getItem(e):null}function U(e,t){if(!window||!window.localStorage)throw new Error("window or window.localStorage do not exist");if(!navigator.cookieEnabled)throw new Error("cookies disabled");return window.localStorage.setItem(e,t)}function Z(e){window&&window.localStorage&&navigator.cookieEnabled&&window.localStorage.removeItem(e)}class H{constructor(e){this.pageVisitId=C()(),this.isClientDisabled=null,this.browserId=null,this.pageVisitSeq=null,this.lastActiveTime=new Date,this.noibuErrorURL=e,this._setupLocalStorageVars(),this.cltErrorPostCounter=0,this.maxSocketInactiveTime=2100}static configureInstance(e){this.instance||(this.noibuErrorURL=e,this.instance=new H(e),this.instance.noibuErrorURL=e)}static getInstance(){if(!this.instance)throw new Error("ClientConfig was not configured");return this.instance}setupBrowserIDCookie(){L()&&(document.cookie="noibuID="+this.browserId)}lockClient(e,t){const n=new Date;n.setMinutes(n.getMinutes()+e);const r=this._getClientState();r.DisabledStatus=!0,r.ClientUnlockTime=n,this._storeBrowserData(r),this.postNoibuErrorAndOptionallyDisableClient(t,!0,"warn")}lockClientUntilNextPage(e){this.postNoibuErrorAndOptionallyDisableClient(e,!0,"warn")}updateLastActiveTime(e){this.lastActiveTime=e;const t=this._getLsObject();t.LastActive=e,this._storeBrowserData(t)}getPageVisitSeq(){if(this._pageVisitSeqNeedsReset()){this.pageVisitSeq=0;const e=this._getLsObject();e.CurrentPageVisitCount=this.pageVisitSeq+1,e.LastActive=new Date,this._storeBrowserData(e)}return this.pageVisitSeq}_getLsObject(){const e=G("n_browser_data");if(!e)return this._generateAndStoreData();let t={};try{t=JSON.parse(e)}catch(e){return this._generateAndStoreData()}return null==t.BrowserId||null==t.DisabledStatus||null==t.CurrentPageVisitCount||null==t.LastActive?this._generateAndStoreData():t}_pageVisitSeqNeedsReset(){const e=this._getClientState(),t=new Date;return t.setMinutes(t.getMinutes()-45),new Date(e.LastActive)<t}_setupLocalStorageVars(){const e=this._getClientState();if(this._pageVisitSeqNeedsReset()&&(e.CurrentPageVisitCount=0),this.browserId=e.BrowserId,this.pageVisitSeq=e.CurrentPageVisitCount,this.isClientDisabled=e.DisabledStatus,this.isClientDisabled||(e.CurrentPageVisitCount+=1,e.LastActive=new Date),m().includes("video")&&(e.pvId=this.pageVisitId),e.CurrentPageVisitCount>=300){H.getInstance().postNoibuErrorAndOptionallyDisableClient("Hit max page visits, disabling client",!0,"error");const t=new Date;t.setMinutes(t.getMinutes()+45),e.ClientUnlockTime=t}null===this._storeBrowserData(e).BrowserId&&(H.getInstance().postNoibuErrorAndOptionallyDisableClient("Null browser in local storage, disabling client",!0,"error"),this.browserId=null)}_getClientState(){const e=this._getLsObject();return e.ClientUnlockTime&&new Date(e.ClientUnlockTime)<=new Date&&(e.ClientUnlockTime=null,e.DisabledStatus=!1,this._storeBrowserData(e)),e}_generateAndStoreData(){return this._storeBrowserData(this._generateNewBrowserData())}_generateNewBrowserData(){const e={DisabledStatus:!1,BrowserId:C()(),CurrentPageVisitCount:0,ClientUnlockTime:null,LastActive:new Date};return m().includes("video")&&(e.pvId=this.pageVisitId),e}_storeBrowserData(e){try{return U("n_browser_data",M(e)),e}catch(e){this.postNoibuErrorAndOptionallyDisableClient("Error writing browser data to local storage, disabling client: "+e.message,!0,"error");return{DisabledStatus:!0,BrowserId:null,CurrentPageVisitCount:0}}}postNoibuErrorAndOptionallyDisableClient(e,t,n,r=!1){if(this.isClientDisabled)return;if(t&&(this.isClientDisabled=!0),"warn"===n)return;let i=`Noibu Browser ID(${this.browserId?this.browserId:""}), PV ID ${this.pageVisitId}, Script ID ${l()}, and User Agent ${window.navigator.userAgent} error: ${B(e)}`;if(this.cltErrorPostCounter>=50){const e=new Date;e.setMinutes(e.getMinutes()+10);const t=this._getClientState();t.DisabledStatus=!0,t.ClientUnlockTime=e,this._storeBrowserData(t),this.isClientDisabled=!0,i="Shutting collect off, we reached the maximum limit of collect errors sent."}const o={url:window.location.href,err_msg:i,sev:n},a={"content-type":"application/json"};r?fetch(this.noibuErrorURL,{method:"POST",headers:a,body:M(o),keepalive:!0}):D("POST",this.noibuErrorURL,o,a,2e3,!1).catch(()=>{}),"error"===n&&(this.cltErrorPostCounter+=1)}isInactive(){const e=new Date;return e.setSeconds(e.getSeconds()-this.maxSocketInactiveTime),this.lastActiveTime<e}}class W{constructor(){this.expectedVideoLength=0,this.expectedVfSeq=0,this.expectedPvPart=0,this.videoClicks=0,this.pvClicks=0,this.errCount=0,this.httpCount=0,this.didCutPv=!1,this.didCutVideo=!1,this.writeTimeout=null,this.didStartVideo=!1,this._setupListeners()}static getInstance(){return this.instance||(this.instance=new W),this.instance}addVideoFragData(e,t){this.expectedVfSeq=e,this.expectedVideoLength=t}setPvPart(e){this.expectedPvPart=e}addVideoClick(){this.videoClicks+=1}addPvClick(){this.pvClicks+=1}addError(){this.errCount+=1}addHttpEvent(){this.httpCount+=1}setDidCutVideo(){this.didCutVideo=!0}setDidStartVideo(){this.didStartVideo=!0}setDidCutPv(){this.didCutPv=!0}_setupListeners(){window.addEventListener("pagehide",()=>{this._postMetricsIfActive("pagehide")})}_postMetricsIfActive(e){H.getInstance().isClientDisabled||H.getInstance().isInactive()||this.postMetrics(e)}postMetrics(e){const t={br_id:H.getInstance().browserId,pv_id:H.getInstance().pageVisitId,cv:2,v:1,exp_vid_len:this.expectedVideoLength,exp_vf_seq:this.expectedVfSeq,exp_pc_seq:this.expectedPvPart,vid_clicks:this.videoClicks,pv_clicks:this.pvClicks,did_cut_pv:this.didCutPv,did_cut_vid:this.didCutVideo,did_start_vid:this.didStartVideo,exp_http:this.httpCount,exp_err:this.errCount,on_url:document.location.href};window.dispatchEvent(new CustomEvent("noibuPostMetrics",{detail:e})),window.fetch&&window.fetch(p()+"/metrics",{method:"POST",headers:{"content-type":"application/json"},body:M(t),keepalive:!0})}}class K{constructor(){this.isLocalStorageSupported=this._testLocalStorageSupported(),this.latestPageVisitFrag=null,this.writeTimeout=null,this.flushedLocalStorage=!1,this.isLocalStorageSupported&&this._postPreviousPageVisit()}static getInstance(){return this.instance||(this.instance=new K),this.instance}checkAndStoreRetryQueue(e,t){const{type:n,payload:r}=e[e.length-1];if("p"!==n||!r.pvp)return;(r.pvp.events?r.pvp.events:[]).filter(e=>"userstep"===e.type||"err"===e.type||"loc"===e.type).length>0&&this.writePageVisitsFromRetryQueue(e,t)}writePageVisitsFromRetryQueue(e,t){const n=[];for(let t=0;t<e.length;t+=1){const{type:r,payload:i}=e[t];if("p"===r){const e=i.pvp;n.push(e)}}this._writePageVisitFrags(n,t)}_writePageVisitFrags(e,t){const n=M({pageVisitFrags:e,pageVisitInfo:t,timestamp:new Date});if(!(n.length>5242880))try{U("n_stored_page_visit",n)}catch(e){Z("n_stored_page_visit");const t=function(){if(!window||!window.localStorage||!window.localStorage.key)return 0;if(!navigator.cookieEnabled)return 0;let e=0;for(let t=0;t<window.localStorage.length;t+=1){const n=window.localStorage.key(t);if(n){const t=G(n);t&&(e+=t.length)}}return e}();H.getInstance().postNoibuErrorAndOptionallyDisableClient(`Error writing page visit to local storage: ${e}, UserAgent: ${navigator.userAgent},  json size: ${n.length}, LS size: ${t}, `,!1,"error")}}_getPostData(){const e=G("n_stored_page_visit");if(!e)return null;let t={};try{t=JSON.parse(e)}catch(t){return Z("n_stored_page_visit"),H.getInstance().postNoibuErrorAndOptionallyDisableClient(`Error parsing page visit string '${e}': ${t}`,!1,"error"),null}if(t.timestamp){const e=new Date;if(e.setSeconds(e.getSeconds()-2100),e>=Date.parse(t.timestamp))return null}const n={pvi:t.pageVisitInfo,pvp:[],pvvf:[]};n.pvi.last=!0;for(let e=0;e<t.pageVisitFrags.length;e+=1)n.pvp.push(t.pageVisitFrags[e]);return n}_testLocalStorageSupported(){try{U("n_key","N".repeat(512))}catch(e){return!1}return Z("n_key"),!0}_postPreviousPageVisit(){this._getPostPageVisitPromise().then(()=>{this._updateLocalStorageFlushed()}).catch(()=>{this._updateLocalStorageFlushed()})}_updateLocalStorageFlushed(){this.flushedLocalStorage=!0,Z("n_stored_page_visit")}_getPostPageVisitPromise(){return new Promise((e,t)=>{const n=this._getPostData();if(!n)return void e();D("POST",h(),n,{"content-type":"application/json"},2e3,!0).then(()=>{e()}).catch(e=>{t(new Error("Page visit post request rejected due to: ",e))})})}}function Y(){return!("now"in Date)||("number"!=typeof Date.now()||(!("toISOString"in new Date)||"string"!=typeof(new Date).toISOString()))}function q(e){if("number"!=typeof e&&Y()){if(Date.prototype.hasOwnProperty("valueOf")&&"function"==typeof e.valueOf&&"number"==typeof e.valueOf())return e.valueOf();H.getInstance().postNoibuErrorAndOptionallyDisableClient("The date object has been overwritten and can't be processed properly.\n      Client has been disabled.",!0,"error",!0)}return e}function X(){return window.performance&&window.performance.now?window.performance.now():q(Date.now())}class Q{constructor(e){const t=g();this.forceClosed=!1,this.socket=null,this.socketInstanceId=null,this.previousMessageType="",this.currentConnectionAttempts=0,this.connectionCount=0,this.sessionStartTime=X(),this.connectionPromise=null,this.pageVisitInfoSent=!1,this.connectionURL=t+"/pv_part",this.postURL=h(),this.messageSequenceNum=0,this.latestReceivedSeqNumber=-1,this.isRetryLoopDisabled=!1,this.retryMessageQueue=[],this.metroplexTypeLock={},this.initialURL=R(),this.initialReferingURL=window.document.referrer?_(window.document.referrer):"",this.sessionTimestamp=new Date,this.latestReceivedSeqNumStoredTime=new Date,this.instanceId=C()(),this.scriptInstanceId=e,this.sessionLength=0,this.socketCloseCodes=[],this.socketOpens=[]}static getInstance(e){return this.instance||(this.instance=new Q(e),this.instance.start()),this.instance}start(){this.connectSocket().finally(new Promise(e=>{this._setupOffloadEvents(),e()}))}_addSeqNumToPayload(e){e.pvp?this._setSeqNumInPayloadAndIncrementSeqNum("pvp",e):e.pvvf?this._setSeqNumInPayloadAndIncrementSeqNum("pvvf",e):e.pvm&&this._setSeqNumInPayloadAndIncrementSeqNum("pvm",e)}_setSeqNumInPayloadAndIncrementSeqNum(e,t){t[e].seq_num=this.messageSequenceNum,this.messageSequenceNum+=1}sendMessage(e,t){if(e in this.metroplexTypeLock||H.getInstance().isClientDisabled)return;const n=t;if(this._addSeqNumToPayload(n),this.retryMessageQueue.push({payload:n,type:e}),K.getInstance().checkAndStoreRetryQueue(this.retryMessageQueue,this.getPageInformation()),this.isConnected()&&this.pageVisitInfoSent&&this._sendSocketMessage(n),this.previousMessageType=e,"p"===e&&t.pvp){const e=t.pvp.events?t.pvp.events:[];this._updateLatestPvTimestamp(e)}}_updateLatestPvTimestamp(e){e.filter(e=>"userstep"===e.type).length>0&&H.getInstance().updateLastActiveTime(new Date)}isConnected(){return null!==this.socket&&1===this.socket.readyState}isConnecting(){return null!==this.socket&&0===this.socket.readyState}close(){this.forceClosed=!0,(this.isConnected()||this.isConnecting())&&this.socket.close(1e3)}handleConnect(e,t){(t||!this.isConnected()&&!this.isConnecting())&&(this.currentConnectionAttempts+=1,this.socket=new WebSocket(this.connectionURL),this.socketInstanceId=C()(),this.socket.onerror=()=>{},this.socket.onclose=t=>{this.pageVisitInfoSent=!1,this.forceClosed||(this.socketCloseCodes.push(`${Y()?"":(new Date).toISOString()}:${t.code}`),this.isConnecting()||(clearInterval(this.retryMetroplexInterval),this.currentConnectionAttempts>=function(){try{return 20}catch(e){return 2}}()?H.getInstance().lockClientUntilNextPage("Too many reconnection attempts, locking until next page"):this.connectionCount>=100?H.getInstance().lockClientUntilNextPage("Too many connections, locking until next page"):setTimeout(()=>{this.handleConnect(e,!1)},this.currentConnectionAttempts**2*function(){try{return METROPLEX_CONSECUTIVE_CONNECTION_DELAY}catch(e){return 1e3}}())))},this.socket.onmessage=e=>{this._onSocketMessage(e)},this.socket.onopen=()=>{this.socketOpens.push(""+(Y()?"":(new Date).toISOString())),this._onSocketOpen(),e()})}connectSocket(){return this.isConnected()||this.isConnecting()||(this.connectionPromise=new Promise(e=>{this.handleConnect(e,!1),window.addEventListener("visibilitychange",()=>{if(H.getInstance().isClientDisabled)return;const t="visible"===document.visibilityState;t&&(this.forceClosed=!1,(this.isConnected()||this.isConnecting())&&(this.socket.onclose=()=>{},this.socket.close(1e3)),this.handleConnect(e,t))})})),this.connectionPromise}addEndTimeToPayload(e,t){const n=Math.ceil(X()-this.sessionStartTime);t&&(this.sessionLength=n);const r=new Date(this.sessionTimestamp.getTime()+n).toISOString();e.end_at=r}_onSocketOpen(){this.isConnected()&&!H.getInstance().isClientDisabled&&(this._sendSocketMessage(this.getPageInformation()),this.pageVisitInfoSent=!0,this.currentConnectionAttempts=0,this.previousMessageType="",this._sendUnconfirmedMessages(),this.setupRetryMechanism(),this.connectionCount+=1)}_onSocketMessage(e){switch(e.data){case"vid_block":this.metroplexTypeLock.v=!0,W.getInstance().setDidCutVideo();break;case"pv_block":this.metroplexTypeLock.p=!0,W.getInstance().setDidCutPv();break;case"full_block":H.getInstance().lockClient(1440,"Metroplex blocked script"),this.close();break;case"close_conn":this.close();break;case"ok":break;default:if(e.data.includes("seq_num")){const t=e.data.split("seq_num:");if(t.length<2){H.getInstance().postNoibuErrorAndOptionallyDisableClient("Invalid message received from metroplex while clearing retry queue "+e.data,!1,"error");break}const n=parseInt(t[1],10);n<=this.latestReceivedSeqNumber?this.isRetryLoopDisabled=!0:(this.isRetryLoopDisabled=!1,this.latestReceivedSeqNumber=n,this._clearRetryQueue(n))}}}_messagePayloadHasLargerSeqNum(e,t,n){return e.payload[t]&&e.payload[t].seq_num&&e.payload[t].seq_num>n}_clearRetryQueue(e){this.latestReceivedSeqNumStoredTime=new Date,this.retryMessageQueue=this.retryMessageQueue.filter(t=>this._messagePayloadHasLargerSeqNum(t,"pvp",e)||this._messagePayloadHasLargerSeqNum(t,"pvvf",e))}_sendUnconfirmedMessages(){if(!this.isConnected()||H.getInstance().isClientDisabled||this.isConnecting())return;const e=new Date;if(e.setSeconds(e.getSeconds()-3e4),!(e>=this.latestReceivedSeqNumStoredTime||this.isRetryLoopDisabled)){this.retryMessageQueue=this.retryMessageQueue.filter(e=>!(e.type in this.metroplexTypeLock));for(let e=0;e<this.retryMessageQueue.length;e+=1){const{type:t,payload:n}=this.retryMessageQueue[e];if(!this._sendSocketMessage(n))break;this.previousMessageType=t}}}setupRetryMechanism(){this.retryMetroplexInterval=setInterval(()=>{this._sendUnconfirmedMessages()},3e4)}_setupOffloadEvents(){window.addEventListener("pagehide",()=>{this._handleUnload()})}_handleUnload(){this.close(),H.getInstance().isClientDisabled||H.getInstance().isInactive()||this.postFullPageVisit(59e3)}postFullPageVisit(e){if(0===this.retryMessageQueue.length)return;const t=[],n={v:0,p:0};let r=0,i={pvi:this.getPageInformation(),pvp:[],pvvf:[],vpnum:this.connectionCount};if(i.pvi.last=!0,this.retryMessageQueue.forEach(o=>{let{type:a,payload:s}=o;const c=new Blob([M(s)]).size;if(c>e)n[a]+=1;else{if(r+=c,r>=e){this.postMessage(i);let e="Vid: "+i.pvvf.length;e+=` PV: ${i.pvp.length},`,t.push(e),i={pvi:this.getPageInformation(),pvp:[],pvvf:[],vpnum:i.vpnum},i.pvi.last=!0,r=0}switch(a){case"v":i.pvvf.push(s.pvvf);break;case"p":i.pvp.push(s.pvp)}}}),this.postMessage(i),this.retryMessageQueue.length>100){let e="Vid: "+i.pvvf.length;e+=` PV: ${i.pvp.length},`,t.push(e);let r="POST Full PV complete";r+=", POSTs count: "+t.length,r+=", POSTs info: "+M(t),r+=", Retry message queue size: "+this.retryMessageQueue.length,n.v>0&&(r+=", Video parts dropped: "+n.v),n.p>0&&(r+=", Page visit parts dropped: "+n.p),r+=", Sequence Info: Latest "+this.messageSequenceNum,r+=` Ack'd ${this.latestReceivedSeqNumStoredTime} ${this.latestReceivedSeqNumber}`;const o=H.getInstance().isClientDisabled;H.getInstance().isClientDisabled=!1,H.getInstance().postNoibuErrorAndOptionallyDisableClient(r,o,"warn")}}postMessage(e){const t=e;t.vpnum+=1,"test"===m()?navigator.sendBeacon(this.postURL,M(t)):window.fetch&&fetch(this.postURL,{method:"POST",headers:{"content-type":"application/json"},body:M(t),keepalive:!0})}_sendSocketMessage(e){return!this.closeIfInactive()&&(this.socket.send(M(e)),!0)}closeIfInactive(){const e=H.getInstance().isInactive();return e&&!H.getInstance().isClientDisabled&&(H.getInstance().lockClientUntilNextPage("Session is inactive, locking until next page"),this.close(),W.getInstance().postMetrics("inactive"),this.postFullPageVisit(59e3)),e}getPageInformation(){const e={br_id:H.getInstance().browserId,pv_id:H.getInstance().pageVisitId,v:5,seq:H.getInstance().getPageVisitSeq(),on_url:this.initialURL,ref_url:this.initialReferingURL,start_at:this.sessionTimestamp.toISOString(),conc:this.connectionCount,cv:2,last:!1,script_id:l(),script_inst_id:this.scriptInstanceId,mp_sock_inst_id:this.instanceId,sock_inst_id:this.socketInstanceId},t=function(){const e=window.navigator.userLanguage||window.navigator.language;return""!==e&&e?e.toLowerCase():null}();return t&&(e.lang=t),e}}class J{constructor(){this.partCounter=0,this.pvMap={},this.partCounter=0,this.pvEventLength=0,this.visibilityChangedCounter=0,this.totalPvEventLength=0,this.inDebounceHandle=0,this.isInAcceleratedPvPostMode=!1}static configureInstance(){this.instance||(this.instance=new J)}static getInstance(){if(!this.instance)throw new Error("Pagevisit was never configured");return this.instance}addPageVisitEvents(e,t){e.forEach(e=>{this._addPageVisitEvent(e,t)}),this._sendPageVisitMessage()}addPageVisitEvent(e,t){const n=this._addPageVisitEvent(e,t);return this._sendPageVisitMessage(),n}_addPageVisitEvent(e,t){if(!("occurredAt"in e)||!("event"in e))throw new Error("missing attributes in the eventObj");const n={type:t,occ_at:e.occurredAt,[t]:e.event};this.pvEventLength>=200&&this._sendPageVisitMessage();const r=C()();return this.pvMap[r]=n,this.pvEventLength+=1,this.totalPvEventLength+=1,r}static makePageVisitFrag(e,t){const n={};return n.events=e,n.pc=t,Q.getInstance().addEndTimeToPayload(n,!0),n}_sendPageVisitMessage(){const e=Object.keys(this.pvMap).map(e=>this.pvMap[e]);if(0===e.length)return;if(this.partCounter>=1e4)return void H.getInstance().lockClientUntilNextPage(`NoibuJS will stop processing parts because we reached max parts: 10000. Variables: \n      total Pv Event Length: ${this.totalPvEventLength}\n      visibility Changed Counter: ${this.visibilityChangedCounter}\n      `);const t=J.makePageVisitFrag(e,this.partCounter);W.getInstance().setPvPart(this.partCounter);const n={pvp:t};Q.getInstance().sendMessage("p",n),this.pvMap={},this.pvEventLength=0,this.partCounter+=1}}class j{constructor(){this.eventsToDebounce={},this.registerInputType("loc",0),this.registerInputType("page",500),this.registerInputType("err",500),this.registerInputType("http",500),this.registerInputType("kbd",500,"userstep"),this._setupUnloadHandler()}static getInstance(){return this.instance||(this.instance=new j),this.instance}registerInputType(e,t,n=e){e in this.eventsToDebounce||(this.eventsToDebounce[e]={timeout:null,events:[],debouncePeriod:t,eventName:n})}addEvent(e,t){if(!(t in this.eventsToDebounce))throw new Error(`Type: ${t} is not in eventsToDebounce`);this.eventsToDebounce[t].events.push({event:e,occurredAt:new Date(q(Date.now())).toISOString()}),this._debouncePvEvents(t)}_debouncePvEvents(e){clearTimeout(this.eventsToDebounce[e].timeout),this.eventsToDebounce[e].timeout=setTimeout(()=>{this.eventsToDebounce[e].timeout=null,J.getInstance().addPageVisitEvents(this.eventsToDebounce[e].events,this.eventsToDebounce[e].eventName),this.eventsToDebounce[e].events=[]},this.eventsToDebounce[e].debouncePeriod)}_setupUnloadHandler(){window.addEventListener("pagehide",()=>{Object.values(this.eventsToDebounce).forEach(e=>{J.getInstance().addPageVisitEvents(e.events,e.eventName)})})}}function z(e){return{url:F(e.filename),type:"js",j_err:T(e.error)}}function $(e,t){let n=t;t.error&&t.error.originalError&&(n=t.error.originalError);let r={};switch(e){case"XMLHttpRequest":r=function(e){return{url:F(e.responseURL),type:"http",h_code:e.status}}(n);break;case"ErrorEvent":r=z(n);break;case"Response":r=function(e){return{url:F(e.url),type:"http",h_code:e.status}}(n);break;case"WrappedException":case"FetchException":r=z(n);break;case"ErrorLogEvent":r=function(e){return{url:F(window.location.href),type:"js",j_err:T(e)}}(n);break;case"UnhandledRejectionError":case"CustomError":r=z(n);break;default:try{r=z(n)}catch(e){return null}}return r.err_src=e,r}function ee(e,t){if("Event"===e)return;const n=$(e,t);if(!n||!n.url)return;const r=n.url;if(function(e){try{return URL(e),!0}catch(e){return!1}}(r)){const e=new URL(r);if(e.hostname in P||!e.protocol.startsWith("http"))return}(function(e){if("js"===e.type){if(e.j_err){const t=e.j_err.frames;if(t&&t.length>0){const n=t[0].file.toLowerCase(),r=t[0].mname.toLowerCase();if(n.includes("noibu")&&!r.includes("nbuwrapper"))return H.getInstance().postNoibuErrorAndOptionallyDisableClient(e,!1,"error"),!0}}if(e.msg){const t=e.msg.toLowerCase();if(t.includes("input.noibu")||t.includes("input.b.noibu"))return H.getInstance().postNoibuErrorAndOptionallyDisableClient(e,!1,"error"),!0}}else if("http"===e.type&&e.url){const t=e.url;if("string"==typeof t)for(let n=0;n<o.length;n+=1){const r=o[n];if(t.includes(r))return H.getInstance().postNoibuErrorAndOptionallyDisableClient(e,!1,"error"),!0}}return!1})(n)||(W.getInstance().addError(),j.getInstance().addEvent(n,"err"))}let te=0;function ne(e){if("function"!=typeof e)return e;try{if(e.__noibu__)return e;if(e.__noibu_wrapped__)return e.__noibu_wrapped__}catch(t){return e}const nbuWrapper=function(...t){try{const n=Array.prototype.slice.call(t).map(e=>ne(e));return e.handleEvent?e.handleEvent.apply(this,n):e.apply(this,n)}catch(e){throw ee("WrappedException",{error:e}),te+=1,setTimeout(()=>{te-=1}),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(nbuWrapper[t]=e[t])}catch(e){}nbuWrapper.prototype=e.prototype||{},Object.defineProperty(e,"__noibu_wrapped__",{enumerable:!1,value:nbuWrapper}),Object.defineProperties(nbuWrapper,{__noibu__:{enumerable:!1,value:!0},__noibu_original__:{enumerable:!1,value:e}});try{Object.getOwnPropertyDescriptor(nbuWrapper,"name").configurable&&Object.defineProperty(nbuWrapper,"name",{get:()=>e.name})}catch(t){return e}return nbuWrapper}function re(e){if(!e)return;const{message:t,stack:n}=e;n&&t&&ee("ErrorLogEvent",{message:t,stack:n})}function ie(e){e.forEach(e=>{e&&(Array.isArray(e)?e.forEach(e=>{re(e)}):re(e))})}function oe(e){e&&e.constructor&&e.constructor.name&&"undefined"!==e.constructor.name&&!(te>0)&&ee(e.constructor.name,e)}function ae(e){if(!e.reason)return;if(!e.reason.message||!e.reason.stack)return;const t=new Error;t.message=e.reason.message,t.stack=e.reason.stack;ee("UnhandledRejectionError",{error:t})}function se(){window.addEventListener("error",oe,!0),window.addEventListener("unhandledrejection",ae,!0),r.forEach(e=>{const t=window[e],n=t&&t.prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(v(n,"addEventListener",(function(e){return function nbuWrapper(t,n,r){if(!n)return e.call(this,t,n,r);let i;if(n.handleEvent){const e=ne(n.handleEvent.bind(n));i=n,i.handleEvent=e}else i=ne(n);return e.call(this,t,i,r)}})),v(n,"removeEventListener",(function(e){return function nbuWrapper(t,n,r){let i=n;try{i=i&&(i.__noibu_wrapped__||i)}catch(e){}return e.call(this,t,i,r)}})))}),a.forEach(e=>{window.console&&window.console[e]&&v(window.console,e,(function(e){return function nbuWrapper(){e.call(window.console,...arguments),ie(Array.from(arguments))}}))})}class ce{constructor(e){const t=e;(!t.resp_time||t.resp_time<0)&&(t.resp_time=0),t.mtd=e.mtd.toUpperCase(),t.url=_(B(t.url)),this.httpEvent=t}saveHTTPEvent(){this.httpEvent&&this.httpEvent.url&&""!==this.httpEvent.url.trim()&&(W.getInstance().addHttpEvent(),j.getInstance().addEvent(this.httpEvent,"http"))}}function ue(e){return"number"!=typeof e||(e>=400||e<=0)}function le(){const e=window;e&&e.hasOwnProperty&&e.hasOwnProperty("fetch")&&v(e,"fetch",(function(e){return function nbuWrapper(t,n){const r=e.call(this,t,n),i=n&&n.method?n.method:"GET",o=new Date;return r.then(e=>{const n=new Date,r=Math.abs(n-o),a={mtd:i,code:e.status,url:t,r_time:r};let s=new ce(a);s.saveHTTPEvent(),s=null,ue(e.status)&&ee("Response",e)}).catch(e=>{!function(e,t){if(!e)return;if(!e.message||!e.stack)return;const n=t||"",r=new Error;r.stack=e.stack;const i=""===n.trim()?"":" on url "+n;r.message=`${e.message}${i}`,ee("FetchException",{error:r})}(e,t)}),r}}))}function de(){const e=window.XMLHttpRequest,t=e&&e.prototype;if(!t||!t.hasOwnProperty||!t.hasOwnProperty("open"))return;const n=Object.getOwnPropertyDescriptor(t,"open");if(!n.writable){if(!n.configurable)return void function(e){const t=Object.getOwnPropertyDescriptor(e,"send");if(!t.writable){if(!t.configurable)return;Object.defineProperty(e,"send",{writable:!0})}v(e,"send",(function(e){return function nbuWrapper(t){const n=t?"POST":"GET",r=new Date;return this.addEventListener("loadend",()=>{const e=new Date,t=Math.abs(e-r),i={mtd:n,code:this.status,url:this.responseURL,r_time:t};let o=new ce(i);o.saveHTTPEvent(),o=null,ue(this.status)&&ee("XMLHttpRequest",this)}),e.call(this,t)}}))}(t);Object.defineProperty(t,"open",{writable:!0})}!function(e){v(e,"open",(function(e){return function nbuWrapper(t,n,r=!0,i=null,o=null){const a=new Date;return this.addEventListener("loadend",()=>{const e=new Date,r=Math.abs(e-a),i={mtd:t,code:this.status,url:n,r_time:r};let o=new ce(i);o.saveHTTPEvent(),o=null,ue(this.status)&&ee("XMLHttpRequest",this)}),e.call(this,t,n,r,i,o)}}))}(t)}function ge(e){const t=e;return t.class=B(t.class),t}const pe=["\\b(view|add|my)\\b.*\\b(cart|bag|basket|bucket|box)\\b","\\b(buy now)\\b","^backorder$","\\b(acquista ora)\\b","\\b(buy this)\\b","\\b(ajouter|mon)\\b.*\\b(panier)\\b","\\b(aggiungi)\\b.*\\b(cart|borsa|carrello)\\b","^ajouter à la shopping bag$","^aggiungi$","^aggiungi alla shopping bag$","\\b(warenkorb)\\b","(^kaufen$)","^купить$","\\b(agregar)\\b.*\\b(carrito)\\b","\\b(adicionar)\\b.*\\b(carrinho)\\b","^carrinho$","^añadir al carrito de compras$","(^añadir al carrito$)","(add another)","(in winkelmand)","(sepete ekle)","(Lagg I Varukorgen)","(ΠΡΟΣΘΗΚΗ ΣΤΟ ΚΑΛΑΘΙ)","(Lägg i varukorgen)","(Köp)","(カートに追加)","^添加至购物袋$","^购买$","^購入する$","(أضف الى السلة)"],he=["(paypal)","(checkout|payment|check out)","(l.?achat|règlement|paiement|la commande)","(passer).*(commande)","valider mon panier","(acheter maintenant)","^caisse$","(gå vidare till kassan)","(cassa|acquisto)","^vai alla cassa$","^procedi all.?acquisto$","^procedi al checkout$","^siguiente$","(kasse)","^zur kasse gehen$","^bezahlen$","^weiter zum checkout$","(comprar ahora)","^comprar$","(prosseguir com a compra)","^pasar por la caja$","^afrekenen$","^compre$","(continue to pay)","(naar de kassa)","Перейти к оформлению заказа","^купить сейчас$","^bestellen$","(Alışverişi Tamamla)","^Till kassan$","(チェックアウトに進む)","^去结算$","^付款。$","^お支払い$","(تاكيد الطلب)"],me=["(checkout|continue) (with paypal)","^continue to paypal$","^weiter zu paypal$","^continue to afterpay$","^braintree_paypal$","^pay and place order$","^mit paypal bezahlen$","^continue to payment securely$","(continua su paypal)","(apple pay|applepay)","(amazon pay|amazonpay|continue with amazon)","(sezzlepay)","(place order)","(place your order)","(order confirmation)","(complete purchase)","submit.*order","(pay now)","(^pay it now$)","(make payment)","(^make payment$)","(complete order)","^complete your order$","(fazer pedido)","^encomendar$","((realizar) (pedido|pago))","^finalizar compra$","^pagar$","^jetzt kaufen$","^bestellung aufgeben$","^bestellung prüfen$","^auftragsbestätigung$","^bestelling plaatsen$","^passer la commande$","(je confirme et je paye)","(accéder au paiement)","^passer au paiement$","(Valider et continuer)","^valider la commande$","(^passez la commande$)","^invia ordine$","(effettua ordine)","^effettua l.?ordine$","(conferma acquisto)","^conferma l.?acquisto$","^confirmation de commande$","^confirma l.?ordine$","^conferma l.?ordine$","^conferma ordine$","(SİPARİŞİ TAMAMLA)","^Разместить заказ$","(Slutför köp)","(注文する)","(إنشاء الطلب)","(注文を確定)","^お支払いへ進む$","^确认下单$"];class fe{constructor(){this.textCapturedWhiteListRegex=new RegExp(pe.concat(he).concat(me).join("|"),"i"),this.htmlIDWhiteListRegex=new RegExp("method|finance|sagepay|cart|bag|coupon|affirm|karna|sezzle|button","i")}static getInstance(){return this.instance||(this.instance=new fe),this.instance}monitorClicks(){window.addEventListener("click",this._onClickHandle.bind(this),!0)}_onClickHandle(e){const t=function(){const e=i(),t=["noibu-blocked"];return O()&&e.sel.forEach(e=>{e.startsWith(".")&&e.length>0&&t.push(e.substring(1))}),t}();if(e.srcElement){const n=e.srcElement;let r="";r="IMG"===n.tagName?n.alt?n.alt:"":this._getTextualContentFromEl(n,!0);let i=this._parseAndTrimText(r);const o=n.className?n.className:"";let a="";n.tagName&&(a=n.tagName.toLowerCase());let s=n.id?n.id:"";if("string"!=typeof s&&(s=""),!this.textCapturedWhiteListRegex.test(i)&&!this.htmlIDWhiteListRegex.test(s)){"input"===a?(!n.type||"button"!==n.type&&"submit"!==n.type)&&(i="*"):"textarea"===a&&(i="*");i=t.filter(e=>e===o).length>0?"*":i}i=function(e){return e.replace(/[0-9]/g,"*")}(i);const c={src:n.src?n.src:"",txt:i,tag:a,hid:s,type:"click",class:o};W.getInstance().addPvClick(),J.getInstance().addPageVisitEvents([{event:ge(c),occurredAt:new Date(q(Date.now())).toISOString()}],"userstep")}}_parseTextFromParentElement(e){let t=e;const n=[];let r=0;for(;t&&!(r>=5)&&t.parentNode;)t=t.parentNode,n.push(t),r+=1;for(let e=0;e<n.length;e+=1){const t=n[e];if(t&&"BUTTON"===t.tagName)return this._getTextualContentFromEl(t,!1,!1)}return""}_getTextualContentFromEl(e,n){let r="";const i=e.tagName?e.tagName.toLowerCase():"";for(let n=0;n<t.length;n+=1){const i=t[n];if(e[i]&&""!==e[i].trim()){r=e[i];break}}if(n)if(""===r)r=this._parseTextFromParentElement(e);else if("select"===i){const t=r;r=this._parseTextFromParentElement(e),r=r.replace(t,"")}return r}_parseAndTrimText(e){let t=e.trim().replace(/\s+/g," ");if(t.length>100){const e=t.lastIndexOf(" ",97);t=e>0?t.substring(0,e)+"...":"..."}return t}}class Ie{constructor(){this.inputsTracked={}}monitor(){this._attachListenersToInputTags("input","textarea"),this._listenForNewInputTags("input","textarea")}_listenForNewInputTags(...e){new MutationObserver(t=>{t.forEach(t=>{for(let n=0;n<t.addedNodes.length;n+=1)if("FORM"===t.addedNodes[n].tagName){const e=t.addedNodes[n].getElementsByTagName("input");Array.prototype.slice.call(e).forEach(e=>{this._attachListenerToTextInput(e)})}else e.forEach(e=>{t.addedNodes[n].tagName===e.toUpperCase()&&this._attachListenerToTextInput(t.addedNodes[n])})})}).observe(window.document,{subtree:!0,childList:!0})}_attachListenersToInputTags(...e){e.forEach(e=>{const t=window.document.getElementsByTagName(e);Array.prototype.slice.call(t).forEach(e=>{this._attachListenerToTextInput(e)})})}_attachListenerToTextInput(e){const t=e.placeholder||e.name||e.id||"";this.inputsTracked[t]||""===t||(this.inputsTracked[t]=!0,e.addEventListener("input",()=>{j.getInstance().addEvent(ge({src:"",txt:t,tag:e.tagName.toLowerCase(),hid:e.id,type:"kbd",class:e.className}),"kbd")}))}}let Ce=window.location.href;class ve{static getInstance(){return this.instance||(this.instance=new ve),this.instance}monitor(){s.forEach(e=>{window.addEventListener(e,this._onPageEventHandle.bind(this),!0)}),c.forEach(e=>{window.document.addEventListener(e,this._onPageEventHandle.bind(this),!0)})}_onPageEventHandle(e){if(!e||!e.type)return;const t={type:e.type};switch(e.type){case"visibilitychange":t.data="state: "+this.getDocumentState();break;case"readystatechange":t.data="state: "+document.readyState;break;case"pagehide":case"pageshow":case"load":e.persisted&&(t.data="persisted: "+e.persisted);break;case"storage":e.key&&(t.data="key: "+e.key);break;case"message":case"messageerror":e.data&&e.origin&&(t.data=`origin: ${e.origin} size: ${this.getSizeInBytes(e.data)}`);break;case"hashchange":e.newURL&&(t.data="newURL: "+e.newURL)}j.getInstance().addEvent(t,"page")}getDocumentState(){return"hidden"===document.visibilityState?"hidden":document.hasFocus()?"active":"passive"}getSizeInBytes(e){let t=e;return"string"!=typeof e&&(t=JSON.stringify(e)),2*t.length}}var Ae,ye=function(){return(ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function be(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function Se(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function we(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ke(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Ee(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function Ne(e){return e.nodeType===e.ELEMENT_NODE}function _e(e){var t,n=null===(t=e)||void 0===t?void 0:t.host;return Boolean(n&&n.shadowRoot&&n.shadowRoot===e)}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Ae||(Ae={}));var Re=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(e){var t;if(!e)return-1;var n=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=n?n:-1},e.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},e.prototype.removeNodeFromMap=function(e){var t=this,n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach((function(e){return t.removeNodeFromMap(e)}))},e.prototype.has=function(e){return this.idNodeMap.has(e)},e.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},e.prototype.add=function(e,t){var n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)},e.prototype.replace=function(e,t){this.idNodeMap.set(e,t)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Te(e){var t=e.maskInputOptions,n=e.tagName,r=e.type,i=e.value,o=e.maskInputFn,a=i||"";return(t[n.toLowerCase()]||t[r])&&(a=o?o(a):"*".repeat(a.length)),a}var Me,De,Oe=1,Le=new RegExp("[^a-z0-9-_:]");function xe(e){try{var t=e.rules||e.cssRules;return t?Array.from(t).map(Ve).join(""):null}catch(e){return null}}function Ve(e){var t=e.cssText;if(function(e){return"styleSheet"in e}(e))try{t=xe(e.styleSheet)||t}catch(e){}return t}var Be=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Fe=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,Pe=/^(data:)([^,]*),(.*)/i;function Ge(e,t){return(e||"").replace(Be,(function(e,n,r,i,o,a){var s,c=r||o||a,u=n||i||"";if(!c)return e;if(!Fe.test(c))return"url("+u+c+u+")";if(Pe.test(c))return"url("+u+c+u+")";if("/"===c[0])return"url("+u+(((s=t).indexOf("//")>-1?s.split("/").slice(0,3).join("/"):s.split("/")[0]).split("?")[0]+c)+u+")";var l=t.split("/"),d=c.split("/");l.pop();for(var g=0,p=d;g<p.length;g++){var h=p[g];"."!==h&&(".."===h?l.pop():l.push(h))}return"url("+u+l.join("/")+u+")"}))}var Ue=/^[^ \t\n\r\u000c]+/,Ze=/^[, \t\n\r\u000c]+/;function He(e,t){if(!t||""===t.trim())return t;var n=e.createElement("a");return n.href=t,n.href}function We(){var e=document.createElement("a");return e.href="",e.href}function Ke(e,t,n,r){return"src"===n||"href"===n&&r||"xlink:href"===n&&r&&"#"!==r[0]?He(e,r):"background"!==n||!r||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n&&r?function(e,t){if(""===t.trim())return t;var n=0;function r(e){var r,i=e.exec(t.substring(n));return i?(r=i[0],n+=r.length,r):""}for(var i=[];r(Ze),!(n>=t.length);){var o=r(Ue);if(","===o.slice(-1))o=He(e,o.substring(0,o.length-1)),i.push(o);else{var a="";o=He(e,o);for(var s=!1;;){var c=t.charAt(n);if(""===c){i.push((o+a).trim());break}if(s)")"===c&&(s=!1);else{if(","===c){n+=1,i.push((o+a).trim());break}"("===c&&(s=!0)}a+=c,n+=1}}}return i.join(", ")}(e,r):"style"===n&&r?Ge(r,We()):"object"===t&&"data"===n&&r?He(e,r):r:He(e,r)}function Ye(e,t,n){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=0;r<e.classList.length;r++){var i=e.classList[r];if(t.test(i))return!0}return!(!n||!e.matches(n))||Ye(e.parentNode,t,n)}return e.nodeType,e.TEXT_NODE,Ye(e.parentNode,t,n)}function qe(e,t){var n,r,i,o,a=t.doc,s=t.mirror,c=t.blockClass,u=t.blockSelector,l=t.maskTextClass,d=t.maskTextSelector,g=t.inlineStylesheet,p=t.maskInputOptions,h=void 0===p?{}:p,m=t.maskTextFn,f=t.maskInputFn,I=t.dataURLOptions,C=void 0===I?{}:I,v=t.inlineImages,A=t.recordCanvas,y=t.keepIframeSrcFn;if(s.getMeta(a)){var b=s.getId(a);r=1===b?void 0:b}switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:Ae.Document,childNodes:[],compatMode:e.compatMode,rootId:r}:{type:Ae.Document,childNodes:[],rootId:r};case e.DOCUMENT_TYPE_NODE:return{type:Ae.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:r};case e.ELEMENT_NODE:for(var S=function e(t,n,r){if(!t)return!1;if(t.nodeType===t.ELEMENT_NODE){var i=!1;return"string"==typeof n?i=void 0!==t.closest?null!==t.closest("."+n):t.classList.contains(n):t.classList.forEach((function(e){n.test(e)&&(i=!0)})),r&&(i=i||t.matches(r)),i||e(t.parentNode,n,r)}return t.nodeType,t.TEXT_NODE,e(t.parentNode,n,r)}(e,c,u),w=function(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return Le.test(t)?"div":t}(e),k={},E=0,N=Array.from(e.attributes);E<N.length;E++){var _=N[E],R=_.name,T=_.value;k[R]=Ke(a,w,R,T)}if("link"===w&&g){var M=Array.from(a.styleSheets).find((function(t){return t.href===e.href})),D=null;M&&(D=xe(M)),D&&(delete k.rel,delete k.href,k._cssText=Ge(D,M.href))}if("style"===w&&e.sheet&&!(e.innerText||e.textContent||"").trim().length)(D=xe(e.sheet))&&(k._cssText=Ge(D,We()));if("input"===w||"textarea"===w||"select"===w){T=e.value;"radio"!==k.type&&"checkbox"!==k.type&&"submit"!==k.type&&"button"!==k.type&&T?k.value=Te({type:k.type,tagName:w,value:T,maskInputOptions:h,maskInputFn:f}):e.checked&&(k.checked=e.checked)}if("option"===w&&(e.selected&&!h.select?k.selected=!0:delete k.selected),"canvas"===w&&A)if("2d"===e.__context)(function(e){var t=e.getContext("2d");if(!t)return!0;for(var n=0;n<e.width;n+=50)for(var r=0;r<e.height;r+=50){var i=t.getImageData,o="__rrweb_original__"in i?i.__rrweb_original__:i;if(new Uint32Array(o.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((function(e){return 0!==e})))return!1}return!0})(e)||(k.rr_dataURL=e.toDataURL(C.type,C.quality));else if(!("__context"in e)){var O=e.toDataURL(C.type,C.quality),L=document.createElement("canvas");L.width=e.width,L.height=e.height,O!==L.toDataURL(C.type,C.quality)&&(k.rr_dataURL=O)}if("img"===w&&v){Me||(Me=a.createElement("canvas"),De=Me.getContext("2d"));var x=e,V=x.crossOrigin;x.crossOrigin="anonymous";var B=function(){try{Me.width=x.naturalWidth,Me.height=x.naturalHeight,De.drawImage(x,0,0),k.rr_dataURL=Me.toDataURL(C.type,C.quality)}catch(e){console.warn("Cannot inline img src="+x.currentSrc+"! Error: "+e)}V?k.crossOrigin=V:delete k.crossOrigin};x.complete&&0!==x.naturalWidth?B():x.onload=B}if("audio"!==w&&"video"!==w||(k.rr_mediaState=e.paused?"paused":"played",k.rr_mediaCurrentTime=e.currentTime),e.scrollLeft&&(k.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(k.rr_scrollTop=e.scrollTop),S){var F=e.getBoundingClientRect(),P=F.width,G=F.height;k={class:k.class,rr_width:P+"px",rr_height:G+"px"}}return"iframe"!==w||y(k.src)||(e.contentDocument||(k.rr_src=k.src),delete k.src),{type:Ae.Element,tagName:w,attributes:k,childNodes:[],isSVG:(o=e,Boolean("svg"===o.tagName||o.ownerSVGElement)||void 0),needBlock:S,rootId:r};case e.TEXT_NODE:var U=e.parentNode&&e.parentNode.tagName,Z=e.textContent,H="STYLE"===U||void 0,W="SCRIPT"===U||void 0;if(H&&Z){try{e.nextSibling||e.previousSibling||(null===(n=e.parentNode.sheet)||void 0===n?void 0:n.cssRules)&&(Z=(i=e.parentNode.sheet).cssRules?Array.from(i.cssRules).map((function(e){return e.cssText||""})).join(""):"")}catch(t){console.warn("Cannot get CSS styles from text's parentNode. Error: "+t,e)}Z=Ge(Z,We())}return W&&(Z="SCRIPT_PLACEHOLDER"),!H&&!W&&Ye(e,l,d)&&Z&&(Z=m?m(Z):Z.replace(/[\S]/g,"*")),{type:Ae.Text,textContent:Z||"",isStyle:H,rootId:r};case e.CDATA_SECTION_NODE:return{type:Ae.CDATA,textContent:"",rootId:r};case e.COMMENT_NODE:return{type:Ae.Comment,textContent:e.textContent||"",rootId:r};default:return!1}}function Xe(e){return void 0===e?"":e.toLowerCase()}function Qe(e,t){var n,r=t.doc,i=t.mirror,o=t.blockClass,a=t.blockSelector,s=t.maskTextClass,c=t.maskTextSelector,u=t.skipChild,l=void 0!==u&&u,d=t.inlineStylesheet,g=void 0===d||d,p=t.maskInputOptions,h=void 0===p?{}:p,m=t.maskTextFn,f=t.maskInputFn,I=t.slimDOMOptions,C=t.dataURLOptions,v=void 0===C?{}:C,A=t.inlineImages,y=void 0!==A&&A,b=t.recordCanvas,S=void 0!==b&&b,w=t.onSerialize,k=t.onIframeLoad,E=t.iframeLoadTimeout,N=void 0===E?5e3:E,_=t.keepIframeSrcFn,R=void 0===_?function(){return!1}:_,T=t.preserveWhiteSpace,M=void 0===T||T,D=qe(e,{doc:r,mirror:i,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,inlineStylesheet:g,maskInputOptions:h,maskTextFn:m,maskInputFn:f,dataURLOptions:v,inlineImages:y,recordCanvas:S,keepIframeSrcFn:R});if(!D)return console.warn(e,"not serialized"),null;if(-2===(n=i.hasNode(e)?i.getId(e):!function(e,t){if(t.comment&&e.type===Ae.Comment)return!0;if(e.type===Ae.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(Xe(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Xe(e.attributes.name)||"icon"===Xe(e.attributes.rel)||"apple-touch-icon"===Xe(e.attributes.rel)||"shortcut icon"===Xe(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&Xe(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(Xe(e.attributes.property).match(/^(og|twitter|fb):/)||Xe(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===Xe(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===Xe(e.attributes.name)||"googlebot"===Xe(e.attributes.name)||"bingbot"===Xe(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===Xe(e.attributes.name)||"generator"===Xe(e.attributes.name)||"framework"===Xe(e.attributes.name)||"publisher"===Xe(e.attributes.name)||"progid"===Xe(e.attributes.name)||Xe(e.attributes.property).match(/^article:/)||Xe(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===Xe(e.attributes.name)||"yandex-verification"===Xe(e.attributes.name)||"csrf-token"===Xe(e.attributes.name)||"p:domain_verify"===Xe(e.attributes.name)||"verify-v1"===Xe(e.attributes.name)||"verification"===Xe(e.attributes.name)||"shopify-checkout-api-token"===Xe(e.attributes.name)))return!0}}return!1}(D,I)&&(M||D.type!==Ae.Text||D.isStyle||D.textContent.replace(/^\s+|\s+$/gm,"").length)?Oe++:-2))return null;var O=Object.assign(D,{id:n});i.add(e,O),w&&w(e);var L=!l;if(O.type===Ae.Element&&(L=L&&!O.needBlock,delete O.needBlock,e.shadowRoot&&(O.isShadowHost=!0)),(O.type===Ae.Document||O.type===Ae.Element)&&L){I.headWhitespace&&O.type===Ae.Element&&"head"===O.tagName&&(M=!1);for(var x={doc:r,mirror:i,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:l,inlineStylesheet:g,maskInputOptions:h,maskTextFn:m,maskInputFn:f,slimDOMOptions:I,dataURLOptions:v,inlineImages:y,recordCanvas:S,preserveWhiteSpace:M,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:N,keepIframeSrcFn:R},V=0,B=Array.from(e.childNodes);V<B.length;V++){(G=Qe(B[V],x))&&O.childNodes.push(G)}if(Ne(e)&&e.shadowRoot)for(var F=0,P=Array.from(e.shadowRoot.childNodes);F<P.length;F++){var G;(G=Qe(P[F],x))&&(G.isShadow=!0,O.childNodes.push(G))}}return e.parentNode&&_e(e.parentNode)&&(O.isShadow=!0),O.type===Ae.Element&&"iframe"===O.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var i,o=!1;try{i=r.document.readyState}catch(e){return}if("complete"===i){"about:blank"===r.location.href&&"about:blank"!==e.src&&""!==e.src?e.addEventListener("load",t):setTimeout(t,0)}else{var a=setTimeout((function(){o||(t(),o=!0)}),n);e.addEventListener("load",(function(){clearTimeout(a),o=!0,t()}))}}}(e,(function(){var t=e.contentDocument;if(t&&k){var n=Qe(t,{doc:t,mirror:i,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:!1,inlineStylesheet:g,maskInputOptions:h,maskTextFn:m,maskInputFn:f,slimDOMOptions:I,dataURLOptions:v,inlineImages:y,recordCanvas:S,preserveWhiteSpace:M,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:N,keepIframeSrcFn:R});n&&k(e,n)}}),N),O}var Je,je,ze,$e,et,tt,nt=/([^\\]):hover/;new RegExp(nt.source,"g");function rt(e,t,n){void 0===n&&(n=document);var r={capture:!0,passive:!0};return n.addEventListener(e,t,r),function(){return n.removeEventListener(e,t,r)}}!function(e){e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin"}(Je||(Je={})),function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration"}(je||(je={})),function(e){e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel"}(ze||(ze={})),function(e){e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2"}($e||($e={})),function(e){e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange"}(et||(et={})),function(e){e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back"}(tt||(tt={}));var it="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",ot={map:{},getId:function(){return console.error(it),-1},getNode:function(){return console.error(it),null},removeNodeFromMap:function(){console.error(it)},has:function(){return console.error(it),!1},reset:function(){console.error(it)}};function at(e,t,n){void 0===n&&(n={});var r=null,i=0;return function(o){var a=Date.now();i||!1!==n.leading||(i=a);var s=t-(a-i),c=this,u=arguments;s<=0||s>t?(r&&(clearTimeout(r),r=null),i=a,e.apply(c,u)):r||!1===n.trailing||(r=setTimeout((function(){i=!1===n.leading?0:Date.now(),r=null,e.apply(c,u)}),s))}}function st(e,t,n,r,i){void 0===i&&(i=window);var o=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,r?n:{set:function(e){var t=this;setTimeout((function(){n.set.call(t,e)}),0),o&&o.set&&o.set.call(this,e)}}),function(){return st(e,t,o||{},!0)}}function ct(e,t,n){try{if(!(t in e))return function(){};var r=e[t],i=n(r);return"function"==typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=i,function(){e[t]=r}}catch(e){return function(){}}}function ut(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function lt(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function dt(e,t,n){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){var r=!1;return"string"==typeof t?r=void 0!==e.closest?null!==e.closest("."+t):e.classList.contains(t):e.classList.forEach((function(e){t.test(e)&&(r=!0)})),n&&(r=r||e.matches(n)),r||dt(e.parentNode,t,n)}return e.nodeType,e.TEXT_NODE,dt(e.parentNode,t,n)}function gt(e,t){return-2===t.getId(e)}function pt(e){return Boolean(e.changedTouches)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(ot=new Proxy(ot,{get:function(e,t,n){return"map"===t&&console.error(it),Reflect.get(e,t,n)}}));!function(){function e(){this.reset()}e.prototype.add=function(e){var t=this.indexes.get(e.parentId),n={id:e.node.id,mutation:e,children:[],texts:[],attributes:[]};t?(n.parent=t,t.children[n.id]=n):this.tree[n.id]=n,this.indexes.set(n.id,n)},e.prototype.remove=function(e,t){var n=this,r=this.indexes.get(e.parentId),i=this.indexes.get(e.id),o=function(e){if(-1!==e){n.removeIdSet.add(e);var r=t.getNode(e);null==r||r.childNodes.forEach((function(e){o(t.getId(e))}))}},a=function(t){n.removeIdSet.add(t.id),Object.values(t.children).forEach((function(e){return a(e)}));var r=n.indexes.get(t.id);if(r){var i=r.parent;i&&(delete r.parent,delete i.children[r.id],n.indexes.delete(e.id))}};i?r?(delete i.parent,delete r.children[i.id],this.indexes.delete(e.id),a(i)):(delete this.tree[i.id],this.indexes.delete(i.id),a(i)):(this.removeNodeMutations.push(e),o(e.id))},e.prototype.text=function(e){var t=this.indexes.get(e.id);t?t.texts.push(e):this.textMutations.push(e)},e.prototype.attribute=function(e){var t=this.indexes.get(e.id);t?t.attributes.push(e):this.attributeMutations.push(e)},e.prototype.scroll=function(e){this.scrollMap.set(e.id,e)},e.prototype.input=function(e){this.inputMap.set(e.id,e)},e.prototype.flush=function(){var e,t,n,r,i=this,o=this.tree,a=this.removeNodeMutations,s=this.textMutations,c=this.attributeMutations,u={source:je.Mutation,removes:a,texts:s,attributes:c,adds:[]},l=function(e,t){t&&i.removeIdSet.add(e.id),u.texts=u.texts.concat(t?[]:e.texts).filter((function(e){return!i.removeIdSet.has(e.id)})),u.attributes=u.attributes.concat(t?[]:e.attributes).filter((function(e){return!i.removeIdSet.has(e.id)})),i.removeIdSet.has(e.id)||i.removeIdSet.has(e.mutation.parentId)||t?Object.values(e.children).forEach((function(e){return l(e,!0)})):(u.adds.push(e.mutation),e.children&&Object.values(e.children).forEach((function(e){return l(e,!1)})))};Object.values(o).forEach((function(e){return l(e,!1)}));try{for(var d=we(this.scrollMap.keys()),g=d.next();!g.done;g=d.next()){var p=g.value;this.removeIdSet.has(p)&&this.scrollMap.delete(p)}}catch(t){e={error:t}}finally{try{g&&!g.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}try{for(var h=we(this.inputMap.keys()),m=h.next();!m.done;m=h.next()){p=m.value;this.removeIdSet.has(p)&&this.inputMap.delete(p)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}var f=new Map(this.scrollMap),I=new Map(this.inputMap);return this.reset(),{mutationData:u,scrollMap:f,inputMap:I}},e.prototype.reset=function(){this.tree=[],this.indexes=new Map,this.removeNodeMutations=[],this.textMutations=[],this.attributeMutations=[],this.removeIdSet=new Set,this.scrollMap=new Map,this.inputMap=new Map},e.prototype.idRemoved=function(e){return this.removeIdSet.has(e)}}();function ht(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function mt(e){return Boolean(null==e?void 0:e.shadowRoot)}function ft(e){return"__ln"in e}var It=function(){function e(){this.length=0,this.head=null}return e.prototype.get=function(e){if(e>=this.length)throw new Error("Position outside of list range");for(var t=this.head,n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t},e.prototype.addNode=function(e){var t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&ft(e.previousSibling)){var n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&ft(e.nextSibling)&&e.nextSibling.__ln.previous){n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;this.length++},e.prototype.removeNode=function(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)},e}(),Ct=function(e,t){return"".concat(e,"@").concat(t)},vt=function(){function e(){var e=this;this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=function(t){t.forEach(e.processMutation),e.emit()},this.emit=function(){var t,n,r,i;if(!e.frozen&&!e.locked){for(var o=[],a=new It,s=function(t){for(var n=t,r=-2;-2===r;)r=(n=n&&n.nextSibling)&&e.mirror.getId(n);return r},c=function(t){for(var n,r,i,c,u,l=t.getRootNode?null===(n=t.getRootNode())||void 0===n?void 0:n.host:null,d=l;null===(i=null===(r=null==d?void 0:d.getRootNode)||void 0===r?void 0:r.call(d))||void 0===i?void 0:i.host;)d=(null===(u=null===(c=null==d?void 0:d.getRootNode)||void 0===c?void 0:c.call(d))||void 0===u?void 0:u.host)||null;var g=!(e.doc.contains(t)||d&&d instanceof Node&&e.doc.contains(d));if(t.parentNode&&!g){var p=_e(t.parentNode)?e.mirror.getId(l):e.mirror.getId(t.parentNode),h=s(t);if(-1===p||-1===h)return a.addNode(t);var m=Qe(t,{doc:e.doc,mirror:e.mirror,blockClass:e.blockClass,blockSelector:e.blockSelector,maskTextClass:e.maskTextClass,maskTextSelector:e.maskTextSelector,skipChild:!0,inlineStylesheet:e.inlineStylesheet,maskInputOptions:e.maskInputOptions,maskTextFn:e.maskTextFn,maskInputFn:e.maskInputFn,slimDOMOptions:e.slimDOMOptions,recordCanvas:e.recordCanvas,inlineImages:e.inlineImages,onSerialize:function(n){ht(n,e.mirror)&&e.iframeManager.addIframe(n),mt(t)&&e.shadowDomManager.addShadowRoot(t.shadowRoot,document)},onIframeLoad:function(t,n){e.iframeManager.attachIframe(t,n,e.mirror),e.shadowDomManager.observeAttachShadow(t)}});m&&o.push({parentId:p,nextId:h,node:m})}};e.mapRemoves.length;)e.mirror.removeNodeFromMap(e.mapRemoves.shift());try{for(var u=we(e.movedSet),l=u.next();!l.done;l=u.next()){var d=l.value;yt(e.removes,d,e.mirror)&&!e.movedSet.has(d.parentNode)||c(d)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}try{for(var g=we(e.addedSet),p=g.next();!p.done;p=g.next()){d=p.value;bt(e.droppedSet,d)||yt(e.removes,d,e.mirror)?bt(e.movedSet,d)?c(d):e.droppedSet.add(d):c(d)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}for(var h=null;a.length;){var m=null;if(h){var f=e.mirror.getId(h.value.parentNode),I=s(h.value);-1!==f&&-1!==I&&(m=h)}if(!m)for(var C=a.length-1;C>=0;C--){var v=a.get(C);if(v){f=e.mirror.getId(v.value.parentNode),I=s(v.value);if(-1!==f&&-1!==I){m=v;break}}}if(!m){for(;a.head;)a.removeNode(a.head.value);break}h=m.previous,a.removeNode(m.value),c(m.value)}var A={texts:e.texts.map((function(t){return{id:e.mirror.getId(t.node),value:t.value}})).filter((function(t){return e.mirror.has(t.id)})),attributes:e.attributes.map((function(t){return{id:e.mirror.getId(t.node),attributes:t.attributes}})).filter((function(t){return e.mirror.has(t.id)})),removes:e.removes,adds:o};(A.texts.length||A.attributes.length||A.removes.length||A.adds.length)&&(e.texts=[],e.attributes=[],e.removes=[],e.addedSet=new Set,e.movedSet=new Set,e.droppedSet=new Set,e.movedMap={},e.mutationCb(A))}},this.processMutation=function(t){var n,r,i,o;if(!gt(t.target,e.mirror))switch(t.type){case"characterData":var a=t.target.textContent;dt(t.target,e.blockClass,e.blockSelector)||a===t.oldValue||e.texts.push({value:Ye(t.target,e.maskTextClass,e.maskTextSelector)&&a?e.maskTextFn?e.maskTextFn(a):a.replace(/[\S]/g,"*"):a,node:t.target});break;case"attributes":var s=t.target;a=t.target.getAttribute(t.attributeName);if("value"===t.attributeName&&(a=Te({maskInputOptions:e.maskInputOptions,tagName:t.target.tagName,type:t.target.getAttribute("type"),value:a,maskInputFn:e.maskInputFn})),dt(t.target,e.blockClass,e.blockSelector)||a===t.oldValue)return;var c=e.attributes.find((function(e){return e.node===t.target}));if(c||(c={node:t.target,attributes:{}},e.attributes.push(c)),"style"===t.attributeName){var u=e.doc.createElement("span");t.oldValue&&u.setAttribute("style",t.oldValue),void 0!==c.attributes.style&&null!==c.attributes.style||(c.attributes.style={});var l=c.attributes.style;try{for(var d=we(Array.from(s.style)),g=d.next();!g.done;g=d.next()){var p=g.value,h=s.style.getPropertyValue(p),m=s.style.getPropertyPriority(p);h===u.style.getPropertyValue(p)&&m===u.style.getPropertyPriority(p)||(l[p]=""===m?h:[h,m])}}catch(e){n={error:e}}finally{try{g&&!g.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}try{for(var f=we(Array.from(u.style)),I=f.next();!I.done;I=f.next()){p=I.value;""===s.style.getPropertyValue(p)&&(l[p]=!1)}}catch(e){i={error:e}}finally{try{I&&!I.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}else c.attributes[t.attributeName]=Ke(e.doc,t.target.tagName,t.attributeName,a);break;case"childList":t.addedNodes.forEach((function(n){return e.genAdds(n,t.target)})),t.removedNodes.forEach((function(n){var r=e.mirror.getId(n),i=_e(t.target)?e.mirror.getId(t.target.host):e.mirror.getId(t.target);dt(t.target,e.blockClass,e.blockSelector)||gt(n,e.mirror)||!function(e,t){return-1!==t.getId(e)}(n,e.mirror)||(e.addedSet.has(n)?(At(e.addedSet,n),e.droppedSet.add(n)):e.addedSet.has(t.target)&&-1===r||function e(t,n){if(_e(t))return!1;var r=n.getId(t);return!n.has(r)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||e(t.parentNode,n))}(t.target,e.mirror)||(e.movedSet.has(n)&&e.movedMap[Ct(r,i)]?At(e.movedSet,n):e.removes.push({parentId:i,id:r,isShadow:!!_e(t.target)||void 0})),e.mapRemoves.push(n))}))}},this.genAdds=function(t,n){if(!n||!dt(n,e.blockClass,e.blockSelector)){if(e.mirror.getMeta(t)){if(gt(t,e.mirror))return;e.movedSet.add(t);var r=null;n&&e.mirror.getMeta(n)&&(r=e.mirror.getId(n)),r&&-1!==r&&(e.movedMap[Ct(e.mirror.getId(t),r)]=!0)}else e.addedSet.add(t),e.droppedSet.delete(t);dt(t,e.blockClass,e.blockSelector)||t.childNodes.forEach((function(t){return e.genAdds(t)}))}}}return e.prototype.init=function(e){var t=this;["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","recordCanvas","inlineImages","slimDOMOptions","doc","mirror","iframeManager","shadowDomManager","canvasManager"].forEach((function(n){t[n]=e[n]}))},e.prototype.freeze=function(){this.frozen=!0,this.canvasManager.freeze()},e.prototype.unfreeze=function(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()},e.prototype.isFrozen=function(){return this.frozen},e.prototype.lock=function(){this.locked=!0,this.canvasManager.lock()},e.prototype.unlock=function(){this.locked=!1,this.canvasManager.unlock(),this.emit()},e.prototype.reset=function(){this.shadowDomManager.reset(),this.canvasManager.reset()},e}();function At(e,t){e.delete(t),t.childNodes.forEach((function(t){return At(e,t)}))}function yt(e,t,n){var r=t.parentNode;if(!r)return!1;var i=n.getId(r);return!!e.some((function(e){return e.id===i}))||yt(e,r,n)}function bt(e,t){var n=t.parentNode;return!!n&&(!!e.has(n)||bt(e,n))}var St=[],wt="undefined"!=typeof CSSGroupingRule,kt="undefined"!=typeof CSSMediaRule,Et="undefined"!=typeof CSSSupportsRule,Nt="undefined"!=typeof CSSConditionRule;function _t(e){try{if("composedPath"in e){var t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch(t){return e.target}}function Rt(e,t){var n,r,i=new vt;St.push(i),i.init(e);var o=window.MutationObserver||window.__rrMutationObserver,a=null===(r=null===(n=null===window||void 0===window?void 0:window.Zone)||void 0===n?void 0:n.__symbol__)||void 0===r?void 0:r.call(n,"MutationObserver");a&&window[a]&&(o=window[a]);var s=new o(i.processMutations.bind(i));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function Tt(e){var t=e.mouseInteractionCb,n=e.doc,r=e.mirror,i=e.blockClass,o=e.blockSelector,a=e.sampling;if(!1===a.mouseInteraction)return function(){};var s=!0===a.mouseInteraction||void 0===a.mouseInteraction?{}:a.mouseInteraction,c=[];return Object.keys(ze).filter((function(e){return Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==s[e]})).forEach((function(e){var a=e.toLowerCase(),s=function(e){return function(n){var a=_t(n);if(!dt(a,i,o)){var s=pt(n)?n.changedTouches[0]:n;if(s){var c=r.getId(a),u=s.clientX,l=s.clientY;t({type:ze[e],id:c,x:u,y:l})}}}}(e);c.push(rt(a,s,n))})),function(){c.forEach((function(e){return e()}))}}function Mt(e){var t=e.scrollCb,n=e.doc,r=e.mirror,i=e.blockClass,o=e.blockSelector;return rt("scroll",at((function(e){var a=_t(e);if(a&&!dt(a,i,o)){var s=r.getId(a);if(a===n){var c=n.scrollingElement||n.documentElement;t({id:s,x:c.scrollLeft,y:c.scrollTop})}else t({id:s,x:a.scrollLeft,y:a.scrollTop})}}),e.sampling.scroll||100),n)}function Dt(e,t){var n=ye({},e);return t||delete n.userTriggered,n}var Ot=["INPUT","TEXTAREA","SELECT"],Lt=new WeakMap;function xt(e){return function(e,t){if(wt&&e.parentRule instanceof CSSGroupingRule||kt&&e.parentRule instanceof CSSMediaRule||Et&&e.parentRule instanceof CSSSupportsRule||Nt&&e.parentRule instanceof CSSConditionRule){var n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else{n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function Vt(e,t){var n,r;void 0===t&&(t={});var i=e.doc.defaultView;if(!i)return function(){};!function(e,t){var n=e.mutationCb,r=e.mousemoveCb,i=e.mouseInteractionCb,o=e.scrollCb,a=e.viewportResizeCb,s=e.inputCb,c=e.mediaInteractionCb,u=e.styleSheetRuleCb,l=e.styleDeclarationCb,d=e.canvasMutationCb,g=e.fontCb;e.mutationCb=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.mutation&&t.mutation.apply(t,Ee([],ke(e),!1)),n.apply(void 0,Ee([],ke(e),!1))},e.mousemoveCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mousemove&&t.mousemove.apply(t,Ee([],ke(e),!1)),r.apply(void 0,Ee([],ke(e),!1))},e.mouseInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mouseInteraction&&t.mouseInteraction.apply(t,Ee([],ke(e),!1)),i.apply(void 0,Ee([],ke(e),!1))},e.scrollCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.scroll&&t.scroll.apply(t,Ee([],ke(e),!1)),o.apply(void 0,Ee([],ke(e),!1))},e.viewportResizeCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.viewportResize&&t.viewportResize.apply(t,Ee([],ke(e),!1)),a.apply(void 0,Ee([],ke(e),!1))},e.inputCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.input&&t.input.apply(t,Ee([],ke(e),!1)),s.apply(void 0,Ee([],ke(e),!1))},e.mediaInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mediaInteaction&&t.mediaInteaction.apply(t,Ee([],ke(e),!1)),c.apply(void 0,Ee([],ke(e),!1))},e.styleSheetRuleCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.styleSheetRule&&t.styleSheetRule.apply(t,Ee([],ke(e),!1)),u.apply(void 0,Ee([],ke(e),!1))},e.styleDeclarationCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.styleDeclaration&&t.styleDeclaration.apply(t,Ee([],ke(e),!1)),l.apply(void 0,Ee([],ke(e),!1))},e.canvasMutationCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.canvasMutation&&t.canvasMutation.apply(t,Ee([],ke(e),!1)),d.apply(void 0,Ee([],ke(e),!1))},e.fontCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.font&&t.font.apply(t,Ee([],ke(e),!1)),g.apply(void 0,Ee([],ke(e),!1))}}(e,t);var o=Rt(e,e.doc),a=function(e){var t=e.mousemoveCb,n=e.sampling,r=e.doc,i=e.mirror;if(!1===n.mousemove)return function(){};var o,a="number"==typeof n.mousemove?n.mousemove:50,s="number"==typeof n.mousemoveCallback?n.mousemoveCallback:500,c=[],u=at((function(e){var n=Date.now()-o;t(c.map((function(e){return e.timeOffset-=n,e})),e),c=[],o=null}),s),l=at((function(e){var t=_t(e),n=pt(e)?e.changedTouches[0]:e,r=n.clientX,a=n.clientY;o||(o=Date.now()),c.push({x:r,y:a,id:i.getId(t),timeOffset:Date.now()-o}),u("undefined"!=typeof DragEvent&&e instanceof DragEvent?je.Drag:e instanceof MouseEvent?je.MouseMove:je.TouchMove)}),a,{trailing:!1}),d=[rt("mousemove",l,r),rt("touchmove",l,r),rt("drag",l,r)];return function(){d.forEach((function(e){return e()}))}}(e),s=Tt(e),c=Mt(e),u=function(e){var t=e.viewportResizeCb,n=-1,r=-1;return rt("resize",at((function(){var e=ut(),i=lt();n===e&&r===i||(t({width:Number(i),height:Number(e)}),n=e,r=i)}),200),window)}(e),l=function(e){var t=e.inputCb,n=e.doc,r=e.mirror,i=e.blockClass,o=e.blockSelector,a=e.ignoreClass,s=e.maskInputOptions,c=e.maskInputFn,u=e.sampling,l=e.userTriggeredOnInput;function d(e){var t=_t(e),r=e.isTrusted;if(t&&"OPTION"===t.tagName&&(t=t.parentElement),t&&t.tagName&&!(Ot.indexOf(t.tagName)<0)&&!dt(t,i,o)){var u=t.type;if(!t.classList.contains(a)){var d=t.value,p=!1;"radio"===u||"checkbox"===u?p=t.checked:(s[t.tagName.toLowerCase()]||s[u])&&(d=Te({maskInputOptions:s,tagName:t.tagName,type:u,value:d,maskInputFn:c})),g(t,Dt({text:d,isChecked:p,userTriggered:r},l));var h=t.name;"radio"===u&&h&&p&&n.querySelectorAll('input[type="radio"][name="'.concat(h,'"]')).forEach((function(e){e!==t&&g(e,Dt({text:e.value,isChecked:!p,userTriggered:!1},l))}))}}}function g(e,n){var i=Lt.get(e);if(!i||i.text!==n.text||i.isChecked!==n.isChecked){Lt.set(e,n);var o=r.getId(e);t(ye(ye({},n),{id:o}))}}var p=("last"===u.input?["change"]:["input","change"]).map((function(e){return rt(e,d,n)})),h=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),m=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"],[HTMLOptionElement.prototype,"selected"]];return h&&h.set&&p.push.apply(p,Ee([],ke(m.map((function(e){return st(e[0],e[1],{set:function(){d({target:this})}})}))),!1)),function(){p.forEach((function(e){return e()}))}}(e),d=function(e){var t=e.mediaInteractionCb,n=e.blockClass,r=e.blockSelector,i=e.mirror,o=e.sampling,a=function(e){return at((function(o){var a=_t(o);if(a&&!dt(a,n,r)){var s=a,c=s.currentTime,u=s.volume,l=s.muted;t({type:e,id:i.getId(a),currentTime:c,volume:u,muted:l})}}),o.media||500)},s=[rt("play",a(0)),rt("pause",a(1)),rt("seeked",a(2)),rt("volumechange",a(3))];return function(){s.forEach((function(e){return e()}))}}(e),g=function(e,t){var n=e.styleSheetRuleCb,r=e.mirror,i=t.win,o=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=function(e,t){var i=r.getId(this.ownerNode);return-1!==i&&n({id:i,adds:[{rule:e,index:t}]}),o.apply(this,arguments)};var a=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=function(e){var t=r.getId(this.ownerNode);return-1!==t&&n({id:t,removes:[{index:e}]}),a.apply(this,arguments)};var s={};wt?s.CSSGroupingRule=i.CSSGroupingRule:(kt&&(s.CSSMediaRule=i.CSSMediaRule),Nt&&(s.CSSConditionRule=i.CSSConditionRule),Et&&(s.CSSSupportsRule=i.CSSSupportsRule));var c={};return Object.entries(s).forEach((function(e){var t=ke(e,2),i=t[0],o=t[1];c[i]={insertRule:o.prototype.insertRule,deleteRule:o.prototype.deleteRule},o.prototype.insertRule=function(e,t){var o=r.getId(this.parentStyleSheet.ownerNode);return-1!==o&&n({id:o,adds:[{rule:e,index:Ee(Ee([],ke(xt(this)),!1),[t||0],!1)}]}),c[i].insertRule.apply(this,arguments)},o.prototype.deleteRule=function(e){var t=r.getId(this.parentStyleSheet.ownerNode);return-1!==t&&n({id:t,removes:[{index:Ee(Ee([],ke(xt(this)),!1),[e],!1)}]}),c[i].deleteRule.apply(this,arguments)}})),function(){i.CSSStyleSheet.prototype.insertRule=o,i.CSSStyleSheet.prototype.deleteRule=a,Object.entries(s).forEach((function(e){var t=ke(e,2),n=t[0],r=t[1];r.prototype.insertRule=c[n].insertRule,r.prototype.deleteRule=c[n].deleteRule}))}}(e,{win:i}),p=function(e,t){var n=e.styleDeclarationCb,r=e.mirror,i=e.ignoreCSSAttributes,o=t.win,a=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=function(e,t,o){var s,c;if(i.has(e))return a.apply(this,arguments);var u=r.getId(null===(c=null===(s=this.parentRule)||void 0===s?void 0:s.parentStyleSheet)||void 0===c?void 0:c.ownerNode);return-1!==u&&n({id:u,set:{property:e,value:t,priority:o},index:xt(this.parentRule)}),a.apply(this,arguments)};var s=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=function(e){var t,o;if(i.has(e))return a.apply(this,arguments);var c=r.getId(null===(o=null===(t=this.parentRule)||void 0===t?void 0:t.parentStyleSheet)||void 0===o?void 0:o.ownerNode);return-1!==c&&n({id:c,remove:{property:e},index:xt(this.parentRule)}),s.apply(this,arguments)},function(){o.CSSStyleDeclaration.prototype.setProperty=a,o.CSSStyleDeclaration.prototype.removeProperty=s}}(e,{win:i}),h=e.collectFonts?function(e){var t=e.fontCb,n=e.doc,r=n.defaultView;if(!r)return function(){};var i=[],o=new WeakMap,a=r.FontFace;r.FontFace=function(e,t,n){var r=new a(e,t,n);return o.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};var s=ct(n.fonts,"add",(function(e){return function(n){return setTimeout((function(){var e=o.get(n);e&&(t(e),o.delete(n))}),0),e.apply(this,[n])}}));return i.push((function(){r.FontFace=a})),i.push(s),function(){i.forEach((function(e){return e()}))}}(e):function(){},m=[];try{for(var f=we(e.plugins),I=f.next();!I.done;I=f.next()){var C=I.value;m.push(C.observer(C.callback,i,C.options))}}catch(e){n={error:e}}finally{try{I&&!I.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}return function(){St.forEach((function(e){return e.reset()})),o.disconnect(),a(),s(),c(),u(),l(),d(),g(),p(),h(),m.forEach((function(e){return e()}))}}for(var Bt=function(){function e(e){this.iframes=new WeakMap,this.mutationCb=e.mutationCb}return e.prototype.addIframe=function(e){this.iframes.set(e,!0)},e.prototype.addLoadListener=function(e){this.loadListener=e},e.prototype.attachIframe=function(e,t,n){var r;this.mutationCb({adds:[{parentId:n.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(r=this.loadListener)||void 0===r||r.call(this,e)},e}(),Ft=function(){function e(e){this.restorePatches=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror;var t=this;this.restorePatches.push(ct(Element.prototype,"attachShadow",(function(e){return function(){var n=e.apply(this,arguments);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,this.ownerDocument),n}})))}return e.prototype.addShadowRoot=function(e,t){Rt(ye(ye({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),Mt(ye(ye({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))},e.prototype.observeAttachShadow=function(e){if(e.contentWindow){var t=this;this.restorePatches.push(ct(e.contentWindow.HTMLElement.prototype,"attachShadow",(function(n){return function(){var r=n.apply(this,arguments);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,e.contentDocument),r}})))}},e.prototype.reset=function(){this.restorePatches.forEach((function(e){return e()}))},e}(),Pt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Gt="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Ut=0;Ut<Pt.length;Ut++)Gt[Pt.charCodeAt(Ut)]=Ut;var Zt=new Map;var Ht=function(e,t,n){if(e&&(Yt(e,t)||"object"==typeof e)){var r=function(e,t){var n=Zt.get(e);return n||(n=new Map,Zt.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name),i=r.indexOf(e);return-1===i&&(i=r.length,r.push(e)),i}};function Wt(e,t,n){if(e instanceof Array)return e.map((function(e){return Wt(e,t,n)}));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer)return{rr_type:e.constructor.name,base64:function(e){var t,n=new Uint8Array(e),r=n.length,i="";for(t=0;t<r;t+=3)i+=Pt[n[t]>>2],i+=Pt[(3&n[t])<<4|n[t+1]>>4],i+=Pt[(15&n[t+1])<<2|n[t+2]>>6],i+=Pt[63&n[t+2]];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i}(e)};if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Wt(e.buffer,t,n),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement)return{rr_type:e.constructor.name,src:e.src};if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}return e instanceof ImageData?{rr_type:e.constructor.name,args:[Wt(e.data,t,n),e.width,e.height]}:Yt(e,t)||"object"==typeof e?{rr_type:e.constructor.name,index:Ht(e,t,n)}:e}var Kt=function(e,t,n){return Ee([],ke(e),!1).map((function(e){return Wt(e,t,n)}))},Yt=function(e,t){var n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((function(e){return"function"==typeof t[e]}));return Boolean(n.find((function(n){return e instanceof t[n]})))};function qt(e,t,n){var r=[];try{var i=ct(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return dt(this,t,n)||"__context"in this||(this.__context=r),e.apply(this,Ee([r],ke(i),!1))}}));r.push(i)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return function(){r.forEach((function(e){return e()}))}}function Xt(e,t,n,r,i,o,a){var s,c,u=[],l=Object.getOwnPropertyNames(e),d=function(s){try{if("function"!=typeof e[s])return"continue";var c=ct(e,s,(function(c){return function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];var d=c.apply(this,u);if(Ht(d,a,e),!dt(this.canvas,r,i)){o.getId(this.canvas);var g=Kt(Ee([],ke(u),!1),a,e),p={type:t,property:s,args:g};n(this.canvas,p)}return d}}));u.push(c)}catch(r){var l=st(e,s,{set:function(e){n(this.canvas,{type:t,property:s,args:[e],setter:!0})}});u.push(l)}};try{for(var g=we(l),p=g.next();!p.done;p=g.next()){d(p.value)}}catch(e){s={error:e}}finally{try{p&&!p.done&&(c=g.return)&&c.call(g)}finally{if(s)throw s.error}}return u}var Qt=n(746);function Jt(e,t,n){var r=void 0===t?null:t,i=function(e,t){return Buffer.from(e,"base64").toString(t?"utf16":"utf8")}(e,void 0!==n&&n),o=i.indexOf("\n",10)+1,a=i.substring(o)+(r?"//# sourceMappingURL="+r:"");return function(e){return new Qt.T(a,Object.assign({},e,{eval:!0}))}}function jt(e,t,n){var r=void 0===t?null:t,i=function(e,t){var n=atob(e);if(t){for(var r=new Uint8Array(n.length),i=0,o=n.length;i<o;++i)r[i]=n.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(r.buffer))}return n}(e,void 0!==n&&n),o=i.indexOf("\n",10)+1,a=i.substring(o)+(r?"//# sourceMappingURL="+r:""),s=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(s)}var zt="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);var $t,en,tn,nn,rn,on=($t="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiAgICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4NCg0KICAgIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueQ0KICAgIHB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC4NCg0KICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIDQogICAgUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZDQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULA0KICAgIElORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTQ0KICAgIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SDQogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUg0KICAgIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuDQogICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi8NCg0KICAgIGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsNCiAgICAgICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9DQogICAgICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH0NCiAgICAgICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTsNCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkgew0KICAgICAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnOw0KICAgICAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgInRocm93IjogdmVyYigxKSwgInJldHVybiI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZzsNCiAgICAgICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9DQogICAgICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHsNCiAgICAgICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7DQogICAgICAgICAgICB3aGlsZSAoXykgdHJ5IHsNCiAgICAgICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5WyJyZXR1cm4iXSA6IG9wWzBdID8geVsidGhyb3ciXSB8fCAoKHQgPSB5WyJyZXR1cm4iXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7DQogICAgICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdOw0KICAgICAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07DQogICAgICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH0NCiAgICAgICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9Ow0KICAgICAgICB9DQogICAgfQoKICAgIC8qCiAgICAgKiBiYXNlNjQtYXJyYXlidWZmZXIgMS4wLjIgPGh0dHBzOi8vZ2l0aHViLmNvbS9uaWtsYXN2aC9iYXNlNjQtYXJyYXlidWZmZXI+CiAgICAgKiBDb3B5cmlnaHQgKGMpIDIwMjIgTmlrbGFzIHZvbiBIZXJ0emVuIDxodHRwczovL2hlcnR6ZW4uY29tPgogICAgICogUmVsZWFzZWQgdW5kZXIgTUlUIExpY2Vuc2UKICAgICAqLwogICAgdmFyIGNoYXJzID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nOwogICAgLy8gVXNlIGEgbG9va3VwIHRhYmxlIHRvIGZpbmQgdGhlIGluZGV4LgogICAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogICAgfQogICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChhcnJheWJ1ZmZlcikgewogICAgICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaSwgbGVuID0gYnl0ZXMubGVuZ3RoLCBiYXNlNjQgPSAnJzsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2ldID4+IDJdOwogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbKChieXRlc1tpXSAmIDMpIDw8IDQpIHwgKGJ5dGVzW2kgKyAxXSA+PiA0KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2kgKyAxXSAmIDE1KSA8PCAyKSB8IChieXRlc1tpICsgMl0gPj4gNildOwogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaSArIDJdICYgNjNdOwogICAgICAgIH0KICAgICAgICBpZiAobGVuICUgMyA9PT0gMikgewogICAgICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAxKSArICc9JzsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobGVuICUgMyA9PT0gMSkgewogICAgICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArICc9PSc7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9OwoKICAgIHZhciBsYXN0QmxvYk1hcCA9IG5ldyBNYXAoKTsNCiAgICB2YXIgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0KSB7DQogICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBpZCwgb2Zmc2NyZWVuLCBibG9iLCBhcnJheUJ1ZmZlciwgYmFzZTY0Ow0KICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkgew0KICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSAiIi5jb25jYXQod2lkdGgsICItIikuY29uY2F0KGhlaWdodCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKV07DQogICAgICAgICAgICAgICAgICAgICAgICBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoJzJkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKCldOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICAgICAgICAgICAgICBibG9iID0gX2Euc2VudCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBibG9iLmFycmF5QnVmZmVyKCldOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICAgICAgICAgICAgICBhcnJheUJ1ZmZlciA9IF9hLnNlbnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBiYXNlNjRdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9DQogICAgdmFyIHdvcmtlciA9IHNlbGY7DQogICAgd29ya2VyLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBfYSwgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgdHJhbnNwYXJlbnRCYXNlNjQsIG9mZnNjcmVlbiwgY3R4LCBibG9iLCB0eXBlLCBhcnJheUJ1ZmZlciwgYmFzZTY0LCBfYjsNCiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHsNCiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCdPZmZzY3JlZW5DYW52YXMnIGluIGdsb2JhbFRoaXMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KV07DQogICAgICAgICAgICAgICAgICAgICAgICBfYSA9IGUuZGF0YSwgaWQgPSBfYS5pZCwgYml0bWFwID0gX2EuYml0bWFwLCB3aWR0aCA9IF9hLndpZHRoLCBoZWlnaHQgPSBfYS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BhcmVudEJhc2U2NCA9IGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpdG1hcC5jbG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBvZmZzY3JlZW4uY29udmVydFRvQmxvYigpXTsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgYmxvYiA9IF9jLnNlbnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIGJsb2IuYXJyYXlCdWZmZXIoKV07DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMjoNCiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5QnVmZmVyID0gX2Muc2VudCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gIWxhc3RCbG9iTWFwLmhhcyhpZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV9iKSByZXR1cm4gWzMsIDRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCB0cmFuc3BhcmVudEJhc2U2NF07DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMzoNCiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gKF9jLnNlbnQoKSkgPT09IGJhc2U2NDsNCiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gNDsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSA0Og0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9iKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiwgd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGlkIH0pXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZDogaWQgfSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlNjQ6IGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH07Cgp9KSgpOwoK",en=null,tn=!1,zt?Jt($t,en,tn):function(e,t,n){var r;return function(i){return r=r||jt(e,t,n),new Worker(r,i)}}($t,en,tn)),an=function(){function e(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=function(e,t){!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};var t=e.sampling,n=void 0===t?"all":t,r=e.win,i=e.blockClass,o=e.blockSelector,a=e.recordCanvas;this.mutationCb=e.mutationCb,this.mirror=e.mirror,a&&"all"===n&&this.initCanvasMutationObserver(r,i,o),a&&"number"==typeof n&&this.initCanvasFPSObserver(n,r,i,o)}return e.prototype.reset=function(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()},e.prototype.freeze=function(){this.frozen=!0},e.prototype.unfreeze=function(){this.frozen=!1},e.prototype.lock=function(){this.locked=!0},e.prototype.unlock=function(){this.locked=!1},e.prototype.initCanvasFPSObserver=function(e,t,n,r){var i=this,o=qt(t,n,r),a=new Map,s=new on;s.onmessage=function(e){var t=e.data.id;if(a.set(t,!1),"base64"in e.data){var n=e.data,r=n.base64,o=n.type,s=n.width,c=n.height;i.mutationCb({id:t,type:$e["2D"],commands:[{property:"clearRect",args:[0,0,s,c]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:o}]},0,0]}]})}};var c,u=1e3/e,l=0,d=function(e){l&&e-l<u||(l=e,t.document.querySelectorAll("canvas:not(.".concat(n," *)")).forEach((function(e){return be(i,void 0,void 0,(function(){var t,n,r,i;return Se(this,(function(o){switch(o.label){case 0:return t=this.mirror.getId(e),a.get(t)?[2]:(a.set(t,!0),["webgl","webgl2"].includes(e.__context)&&(n=e.getContext(e.__context),!1===(null===(i=null==n?void 0:n.getContextAttributes())||void 0===i?void 0:i.preserveDrawingBuffer)&&(null==n||n.clear(n.COLOR_BUFFER_BIT))),[4,createImageBitmap(e)]);case 1:return r=o.sent(),s.postMessage({id:t,bitmap:r,width:e.width,height:e.height},[r]),[2]}}))}))}))),c=requestAnimationFrame(d)};c=requestAnimationFrame(d),this.resetObservers=function(){o(),cancelAnimationFrame(c)}},e.prototype.initCanvasMutationObserver=function(e,t,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();var r=qt(e,t,n),i=function(e,t,n,r,i){var o,a,s=[],c=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype),u=function(i){try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[i])return"continue";var o=ct(t.CanvasRenderingContext2D.prototype,i,(function(o){return function(){for(var a=this,s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];return dt(this.canvas,n,r)||setTimeout((function(){var n=Kt(Ee([],ke(s),!1),t,a);e(a.canvas,{type:$e["2D"],property:i,args:n})}),0),o.apply(this,s)}}));s.push(o)}catch(n){var a=st(t.CanvasRenderingContext2D.prototype,i,{set:function(t){e(this.canvas,{type:$e["2D"],property:i,args:[t],setter:!0})}});s.push(a)}};try{for(var l=we(c),d=l.next();!d.done;d=l.next()){u(d.value)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}return function(){s.forEach((function(e){return e()}))}}(this.processMutation.bind(this),e,t,n,this.mirror),o=function(e,t,n,r,i){var o=[];return o.push.apply(o,Ee([],ke(Xt(t.WebGLRenderingContext.prototype,$e.WebGL,e,n,r,i,t)),!1)),void 0!==t.WebGL2RenderingContext&&o.push.apply(o,Ee([],ke(Xt(t.WebGL2RenderingContext.prototype,$e.WebGL2,e,n,r,i,t)),!1)),function(){o.forEach((function(e){return e()}))}}(this.processMutation.bind(this),e,t,n,this.mirror);this.resetObservers=function(){r(),i(),o()}},e.prototype.startPendingCanvasMutationFlusher=function(){var e=this;requestAnimationFrame((function(){return e.flushPendingCanvasMutations()}))},e.prototype.startRAFTimestamping=function(){var e=this,t=function(n){e.rafStamps.latestId=n,requestAnimationFrame(t)};requestAnimationFrame(t)},e.prototype.flushPendingCanvasMutations=function(){var e=this;this.pendingCanvasMutations.forEach((function(t,n){var r=e.mirror.getId(n);e.flushPendingCanvasMutationFor(n,r)})),requestAnimationFrame((function(){return e.flushPendingCanvasMutations()}))},e.prototype.flushPendingCanvasMutationFor=function(e,t){if(!this.frozen&&!this.locked){var n=this.pendingCanvasMutations.get(e);if(n&&-1!==t){var r=n.map((function(e){return e.type,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["type"])})),i=n[0].type;this.mutationCb({id:t,type:i,commands:r}),this.pendingCanvasMutations.delete(e)}}},e}();function sn(e){return ye(ye({},e),{timestamp:Date.now()})}var cn=new Re;function un(e){void 0===e&&(e={});var t=e.emit,n=e.checkoutEveryNms,r=e.checkoutEveryNth,i=e.blockClass,o=void 0===i?"rr-block":i,a=e.blockSelector,s=void 0===a?null:a,c=e.ignoreClass,u=void 0===c?"rr-ignore":c,l=e.maskTextClass,d=void 0===l?"rr-mask":l,g=e.maskTextSelector,p=void 0===g?null:g,h=e.inlineStylesheet,m=void 0===h||h,f=e.maskAllInputs,I=e.maskInputOptions,C=e.slimDOMOptions,v=e.maskInputFn,A=e.maskTextFn,y=e.hooks,b=e.packFn,S=e.sampling,w=void 0===S?{}:S,k=e.mousemoveWait,E=e.recordCanvas,N=void 0!==E&&E,_=e.userTriggeredOnInput,R=void 0!==_&&_,T=e.collectFonts,M=void 0!==T&&T,D=e.inlineImages,O=void 0!==D&&D,L=e.plugins,x=e.keepIframeSrcFn,V=void 0===x?function(){return!1}:x,B=e.ignoreCSSAttributes,F=void 0===B?new Set([]):B;if(!t)throw new Error("emit function is required");void 0!==k&&void 0===w.mousemove&&(w.mousemove=k),cn.reset();var P,G,U=!0===f?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==I?I:{password:!0},Z=!0===C||"all"===C?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===C,headMetaDescKeywords:"all"===C}:C||{};void 0===P&&(P=window),"NodeList"in P&&!P.NodeList.prototype.forEach&&(P.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in P&&!P.DOMTokenList.prototype.forEach&&(P.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(e){if(!(0 in arguments))throw new TypeError("1 argument is required");do{if(this===e)return!0}while(e=e&&e.parentNode);return!1});var H=0;nn=function(e,i){var o;if(!(null===(o=St[0])||void 0===o?void 0:o.isFrozen())||e.type===Je.FullSnapshot||e.type===Je.IncrementalSnapshot&&e.data.source===je.Mutation||St.forEach((function(e){return e.unfreeze()})),t(function(e){var t,n;try{for(var r=we(L||[]),i=r.next();!i.done;i=r.next()){var o=i.value;o.eventProcessor&&(e=o.eventProcessor(e))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return b&&(e=b(e)),e}(e),i),e.type===Je.FullSnapshot)G=e,H=0;else if(e.type===Je.IncrementalSnapshot){if(e.data.source===je.Mutation&&e.data.isAttachIframe)return;H++;var a=r&&H>=r,s=n&&e.timestamp-G.timestamp>n;(a||s)&&rn(!0)}};var W=function(e){nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.Mutation},e)}))},K=function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.Scroll},e)}))},Y=function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.CanvasMutation},e)}))},q=new Bt({mutationCb:W}),X=new an({recordCanvas:N,mutationCb:Y,win:window,blockClass:o,blockSelector:s,mirror:cn,sampling:w.canvas}),Q=new Ft({mutationCb:W,scrollCb:K,bypassOptions:{blockClass:o,blockSelector:s,maskTextClass:d,maskTextSelector:p,inlineStylesheet:m,maskInputOptions:U,maskTextFn:A,maskInputFn:v,recordCanvas:N,inlineImages:O,sampling:w,slimDOMOptions:Z,iframeManager:q,canvasManager:X},mirror:cn});rn=function(e){var t,n,r,i;void 0===e&&(e=!1),nn(sn({type:Je.Meta,data:{href:window.location.href,width:lt(),height:ut()}}),e),St.forEach((function(e){return e.lock()}));var a=function(e,t){var n=t||{},r=n.mirror,i=void 0===r?new Re:r,o=n.blockClass,a=void 0===o?"rr-block":o,s=n.blockSelector,c=void 0===s?null:s,u=n.maskTextClass,l=void 0===u?"rr-mask":u,d=n.maskTextSelector,g=void 0===d?null:d,p=n.inlineStylesheet,h=void 0===p||p,m=n.inlineImages,f=void 0!==m&&m,I=n.recordCanvas,C=void 0!==I&&I,v=n.maskAllInputs,A=void 0!==v&&v,y=n.maskTextFn,b=n.maskInputFn,S=n.slimDOM,w=void 0!==S&&S,k=n.dataURLOptions,E=n.preserveWhiteSpace,N=n.onSerialize,_=n.onIframeLoad,R=n.iframeLoadTimeout,T=n.keepIframeSrcFn;return Qe(e,{doc:e,mirror:i,blockClass:a,blockSelector:c,maskTextClass:l,maskTextSelector:g,skipChild:!1,inlineStylesheet:h,maskInputOptions:!0===A?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===A?{password:!0}:A,maskTextFn:y,maskInputFn:b,slimDOMOptions:!0===w||"all"===w?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===w,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===w?{}:w,dataURLOptions:k,inlineImages:f,recordCanvas:C,preserveWhiteSpace:E,onSerialize:N,onIframeLoad:_,iframeLoadTimeout:R,keepIframeSrcFn:void 0===T?function(){return!1}:T})}(document,{mirror:cn,blockClass:o,blockSelector:s,maskTextClass:d,maskTextSelector:p,inlineStylesheet:m,maskAllInputs:U,maskTextFn:A,slimDOM:Z,recordCanvas:N,inlineImages:O,onSerialize:function(e){ht(e,cn)&&q.addIframe(e),mt(e)&&Q.addShadowRoot(e.shadowRoot,document)},onIframeLoad:function(e,t){q.attachIframe(e,t,cn),Q.observeAttachShadow(e)},keepIframeSrcFn:V});if(!a)return console.warn("Failed to snapshot the document");nn(sn({type:Je.FullSnapshot,data:{node:a,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null===(n=null===(t=null===document||void 0===document?void 0:document.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===document||void 0===document?void 0:document.body.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null===(i=null===(r=null===document||void 0===document?void 0:document.body)||void 0===r?void 0:r.parentElement)||void 0===i?void 0:i.scrollTop)||(null===document||void 0===document?void 0:document.body.scrollTop)||0}}})),St.forEach((function(e){return e.unlock()}))};try{var J=[];J.push(rt("DOMContentLoaded",(function(){nn(sn({type:Je.DomContentLoaded,data:{}}))})));var j=function(e){var t;return Vt({mutationCb:W,mousemoveCb:function(e,t){return nn(sn({type:Je.IncrementalSnapshot,data:{source:t,positions:e}}))},mouseInteractionCb:function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.MouseInteraction},e)}))},scrollCb:K,viewportResizeCb:function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.ViewportResize},e)}))},inputCb:function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.Input},e)}))},mediaInteractionCb:function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.MediaInteraction},e)}))},styleSheetRuleCb:function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.StyleSheetRule},e)}))},styleDeclarationCb:function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.StyleDeclaration},e)}))},canvasMutationCb:Y,fontCb:function(e){return nn(sn({type:Je.IncrementalSnapshot,data:ye({source:je.Font},e)}))},blockClass:o,ignoreClass:u,maskTextClass:d,maskTextSelector:p,maskInputOptions:U,inlineStylesheet:m,sampling:w,recordCanvas:N,inlineImages:O,userTriggeredOnInput:R,collectFonts:M,doc:e,maskInputFn:v,maskTextFn:A,blockSelector:s,slimDOMOptions:Z,mirror:cn,iframeManager:q,shadowDomManager:Q,canvasManager:X,ignoreCSSAttributes:F,plugins:(null===(t=null==L?void 0:L.filter((function(e){return e.observer})))||void 0===t?void 0:t.map((function(e){return{observer:e.observer,options:e.options,callback:function(t){return nn(sn({type:Je.Plugin,data:{plugin:e.name,payload:t}}))}}})))||[]},y)};q.addLoadListener((function(e){(function(e){var t=null;try{t=e.contentDocument.body.innerHTML}catch(e){}return null!==t})(e)&&J.push(j(e.contentDocument))}));var z=function(){rn(),J.push(j(document))};return"interactive"===document.readyState||"complete"===document.readyState?z():J.push(rt("load",(function(){nn(sn({type:Je.Load,data:{}})),z()}),window)),function(){J.forEach((function(e){return e()}))}}catch(e){console.warn(e)}}un.addCustomEvent=function(e,t){if(!nn)throw new Error("please add custom event after start recording");nn(sn({type:Je.Custom,data:{tag:e,payload:t}}))},un.freezePage=function(){St.forEach((function(e){return e.freeze()}))},un.takeFullSnapshot=function(e){if(!rn)throw new Error("please take full snapshot after start recording");rn(e)},un.mirror=cn;var ln=Uint8Array,dn=Uint16Array,gn=Uint32Array,pn=new ln([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hn=new ln([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mn=new ln([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),fn=function(e,t){for(var n=new dn(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new gn(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},In=fn(pn,2),Cn=In[0],vn=In[1];Cn[28]=258,vn[258]=28;for(var An=fn(hn,0),yn=(An[0],An[1]),bn=new dn(32768),Sn=0;Sn<32768;++Sn){var wn=(43690&Sn)>>>1|(21845&Sn)<<1;wn=(61680&(wn=(52428&wn)>>>2|(13107&wn)<<2))>>>4|(3855&wn)<<4,bn[Sn]=((65280&wn)>>>8|(255&wn)<<8)>>>1}var kn=function(e,t,n){for(var r=e.length,i=0,o=new dn(t);i<r;++i)++o[e[i]-1];var a,s=new dn(t);for(i=0;i<t;++i)s[i]=s[i-1]+o[i-1]<<1;if(n){a=new dn(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],l=t-e[i],d=s[e[i]-1]++<<l,g=d|(1<<l)-1;d<=g;++d)a[bn[d]>>>c]=u}else for(a=new dn(r),i=0;i<r;++i)a[i]=bn[s[e[i]-1]++]>>>15-e[i];return a},En=new ln(288);for(Sn=0;Sn<144;++Sn)En[Sn]=8;for(Sn=144;Sn<256;++Sn)En[Sn]=9;for(Sn=256;Sn<280;++Sn)En[Sn]=7;for(Sn=280;Sn<288;++Sn)En[Sn]=8;var Nn=new ln(32);for(Sn=0;Sn<32;++Sn)Nn[Sn]=5;var _n=kn(En,9,0),Rn=kn(Nn,5,0),Tn=function(e){return(e/8>>0)+(7&e&&1)},Mn=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof dn?dn:e instanceof gn?gn:ln)(n-t);return r.set(e.subarray(t,n)),r},Dn=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8},On=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},Ln=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,o=n.slice();if(!i)return[new ln(0),0];if(1==i){var a=new ln(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var s=n[0],c=n[1],u=0,l=1,d=2;for(n[0]={s:-1,f:s.f+c.f,l:s,r:c};l!=i-1;)s=n[n[u].f<n[d].f?u++:d++],c=n[u!=l&&n[u].f<n[d].f?u++:d++],n[l++]={s:-1,f:s.f+c.f,l:s,r:c};var g=o[0].s;for(r=1;r<i;++r)o[r].s>g&&(g=o[r].s);var p=new dn(g+1),h=xn(n[l-1],p,0);if(h>t){r=0;var m=0,f=h-t,I=1<<f;for(o.sort((function(e,t){return p[t.s]-p[e.s]||e.f-t.f}));r<i;++r){var C=o[r].s;if(!(p[C]>t))break;m+=I-(1<<h-p[C]),p[C]=t}for(m>>>=f;m>0;){var v=o[r].s;p[v]<t?m-=1<<t-p[v]++-1:++r}for(;r>=0&&m;--r){var A=o[r].s;p[A]==t&&(--p[A],++m)}h=t}return[new ln(p),h]},xn=function(e,t,n){return-1==e.s?Math.max(xn(e.l,t,n+1),xn(e.r,t,n+1)):t[e.s]=n},Vn=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new dn(++t),r=0,i=e[0],o=1,a=function(e){n[r++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=e[s]}return[n.subarray(0,r),t]},Bn=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Fn=function(e,t,n){var r=n.length,i=Tn(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<r;++o)e[i+o+4]=n[o];return 8*(i+4+r)},Pn=function(e,t,n,r,i,o,a,s,c,u,l){Dn(t,l++,n),++i[256];for(var d=Ln(i,15),g=d[0],p=d[1],h=Ln(o,15),m=h[0],f=h[1],I=Vn(g),C=I[0],v=I[1],A=Vn(m),y=A[0],b=A[1],S=new dn(19),w=0;w<C.length;++w)S[31&C[w]]++;for(w=0;w<y.length;++w)S[31&y[w]]++;for(var k=Ln(S,7),E=k[0],N=k[1],_=19;_>4&&!E[mn[_-1]];--_);var R,T,M,D,O=u+5<<3,L=Bn(i,En)+Bn(o,Nn)+a,x=Bn(i,g)+Bn(o,m)+a+14+3*_+Bn(S,E)+(2*S[16]+3*S[17]+7*S[18]);if(O<=L&&O<=x)return Fn(t,l,e.subarray(c,c+u));if(Dn(t,l,1+(x<L)),l+=2,x<L){R=kn(g,p,0),T=g,M=kn(m,f,0),D=m;var V=kn(E,N,0);Dn(t,l,v-257),Dn(t,l+5,b-1),Dn(t,l+10,_-4),l+=14;for(w=0;w<_;++w)Dn(t,l+3*w,E[mn[w]]);l+=3*_;for(var B=[C,y],F=0;F<2;++F){var P=B[F];for(w=0;w<P.length;++w){var G=31&P[w];Dn(t,l,V[G]),l+=E[G],G>15&&(Dn(t,l,P[w]>>>5&127),l+=P[w]>>>12)}}}else R=_n,T=En,M=Rn,D=Nn;for(w=0;w<s;++w)if(r[w]>255){G=r[w]>>>18&31;On(t,l,R[G+257]),l+=T[G+257],G>7&&(Dn(t,l,r[w]>>>23&31),l+=pn[G]);var U=31&r[w];On(t,l,M[U]),l+=D[U],U>3&&(On(t,l,r[w]>>>5&8191),l+=hn[U])}else On(t,l,R[r[w]]),l+=T[r[w]];return On(t,l,R[256]),l+T[256]},Gn=new gn([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Un=new ln(0),Zn=function(e,t,n,r,i){return function(e,t,n,r,i,o){var a=e.length,s=new ln(r+a+5*(1+Math.floor(a/7e3))+i),c=s.subarray(r,s.length-i),u=0;if(!t||a<8)for(var l=0;l<=a;l+=65535){var d=l+65535;d<a?u=Fn(c,u,e.subarray(l,d)):(c[l]=o,u=Fn(c,u,e.subarray(l,a)))}else{for(var g=Gn[t-1],p=g>>>13,h=8191&g,m=(1<<n)-1,f=new dn(32768),I=new dn(m+1),C=Math.ceil(n/3),v=2*C,A=function(t){return(e[t]^e[t+1]<<C^e[t+2]<<v)&m},y=new gn(25e3),b=new dn(288),S=new dn(32),w=0,k=0,E=(l=0,0),N=0,_=0;l<a;++l){var R=A(l),T=32767&l,M=I[R];if(f[T]=M,I[R]=T,N<=l){var D=a-l;if((w>7e3||E>24576)&&D>423){u=Pn(e,c,0,y,b,S,k,E,_,l-_,u),E=w=k=0,_=l;for(var O=0;O<286;++O)b[O]=0;for(O=0;O<30;++O)S[O]=0}var L=2,x=0,V=h,B=T-M&32767;if(D>2&&R==A(l-B))for(var F=Math.min(p,D)-1,P=Math.min(32767,l),G=Math.min(258,D);B<=P&&--V&&T!=M;){if(e[l+L]==e[l+L-B]){for(var U=0;U<G&&e[l+U]==e[l+U-B];++U);if(U>L){if(L=U,x=B,U>F)break;var Z=Math.min(B,U-2),H=0;for(O=0;O<Z;++O){var W=l-B+O+32768&32767,K=W-f[W]+32768&32767;K>H&&(H=K,M=W)}}}B+=(T=M)-(M=f[T])+32768&32767}if(x){y[E++]=268435456|vn[L]<<18|yn[x];var Y=31&vn[L],q=31&yn[x];k+=pn[Y]+hn[q],++b[257+Y],++S[q],N=l+L,++w}else y[E++]=e[l],++b[e[l]]}}u=Pn(e,c,o,y,b,S,k,E,_,l-_,u),o||(u=Fn(c,u,Un))}return Mn(s,0,r+Tn(u)+i)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,r,!i)};function Hn(e,t){void 0===t&&(t={});var n=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,o=n.length,a=0;a!=o;){for(var s=Math.min(a+5552,o);a<s;++a)i+=r+=n[a];r%=65521,i%=65521}e=r,t=i},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+2*((255&e)<<23)}}}();n.p(e);var r=Zn(e,t,2,4);return function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)}(r,t),function(e,t,n){for(;n;++t)e[t]=n,n>>>=8}(r,r.length-4,n.d()),r}var Wn=function(e){var t=ye(ye({},e),{v:"v1"});return function(e,t){var n="";if(!t&&"undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var r=0;r<e.length;){var i=e[r++];i<128||t?n+=String.fromCharCode(i):i<224?n+=String.fromCharCode((31&i)<<6|63&e[r++]):i<240?n+=String.fromCharCode((15&i)<<12|(63&e[r++])<<6|63&e[r++]):(i=((15&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}return n}(Hn(function(e,t){var n=e.length;if(!t&&"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var r=new ln(e.length+(e.length>>>1)),i=0,o=function(e){r[i++]=e},a=0;a<n;++a){if(i+5>r.length){var s=new ln(i+8+(n-a<<1));s.set(r),r=s}var c=e.charCodeAt(a);c<128||t?o(c):c<2048?(o(192|c>>>6),o(128|63&c)):c>55295&&c<57344?(o(240|(c=65536+(1047552&c)|1023&e.charCodeAt(++a))>>>18),o(128|c>>>12&63),o(128|c>>>6&63),o(128|63&c)):(o(224|c>>>12),o(128|c>>>6&63),o(128|63&c))}return Mn(r,0,i)}(JSON.stringify(t))),!0)},Kn=un.addCustomEvent;un.freezePage;class Yn{constructor(){this.eventBuffer=[],this.vfCounter=0,this.didSetupRecorder=!1,this.recordStopper=null,this.firstRecordedTimestamp=null,this.lastRecordedTimestamp=null,this.invalidVideoLength=!1,this.lastFragPostTimestamp=new Date,this.pauseTimeout=!1,this.freezingEvents=!1,this.cssURLs=new Map,this.pageStateHistory=[],this.lastRRWebEvent=null,this.setupUnloadHandler(),this.setupPostMetricsHandler()}static configureInstance(){this.instance||(this.instance=new Yn,window.addEventListener("click",()=>{this.instance.handleFragPost()}))}static getInstance(){if(!this.instance)throw new Error("SessionRecorder was not configured");return this.instance}addCSSURLs(e){this.cssURLs.get(e)||this.cssURLs.set(e,{seq_sent:Q.getInstance().messageSequenceNum,received:!1})}checkForCSSURLs(e){if(3===e.type||2===e.type){const t=JSON.stringify(e).match(f);t&&t.length>0&&t.forEach(e=>{if(e.length>0&&e.startsWith('"href":')){e.substring(7).split(/['"]/).forEach(e=>{e.includes(".css")&&this.addCSSURLs(e)})}})}}getCSSURLsNotReceived(){const{latestReceivedSeqNumber:e}=Q.getInstance(),t=[];return this.cssURLs.forEach((n,r)=>{if(!n.received&&n.seq_sent<e){const e=n;e.received=!0,this.cssURLs.set(r,e)}else n.received||t.push(r)}),t}setupUnloadHandler(){["pagehide","visibilitychange"].forEach(e=>window.addEventListener(e,()=>{this.pageStateHistory.push(`${Y()?"":(new Date).toISOString()}: ${e}`),"pagehide"===e&&this.handleFragPost()}))}setupPostMetricsHandler(){window.addEventListener("noibuPostMetrics",e=>{const t=e.detail,n=null===this.lastRecordedTimestamp||null===this.firstRecordedTimestamp?0:this.lastRecordedTimestamp-this.firstRecordedTimestamp,r=Q.getInstance().sessionLength?Q.getInstance().sessionLength:0;if(Q.getInstance().retryMessageQueue.length>100){const e=this.buildDebugMessage(t,n,r),i=H.getInstance().isClientDisabled;H.getInstance().isClientDisabled=!1,H.getInstance().postNoibuErrorAndOptionallyDisableClient(e,i,"warn")}})}recordUserSession(){if(Q.getInstance().closeIfInactive()||W.getInstance().didCutVideo)return;if(this.didSetupRecorder)return;const e=this,t={emit(t){e.handleNewRRwebEvent(t,2e3)},inlineStylesheet:!1,maskAllInputs:!0,blockSelector:x(),ignoreCSSAttributes:u};W.getInstance().setDidStartVideo(),e.recordStopper=un(t),this.didSetupRecorder=!0}handleNewRRwebEvent(e,t){if(Q.getInstance().closeIfInactive()||W.getInstance().didCutVideo)return void(this.recordStopper&&this.recordStopper());if(5===e.type&&"unfreeze"===e.data.tag)return;if(3===e.type&&0===e.data.source||(this.pauseTimeout&&(clearTimeout(this.pauseTimeout),this.freezingEvents=!1),this.pauseTimeout=setTimeout((function(){Yn.getInstance().freezingEvents=!0,un.freezePage()}),t)),e.timestamp=q(e.timestamp),this.firstRecordedTimestamp||(this.firstRecordedTimestamp=e.timestamp),(!this.lastRecordedTimestamp||e.timestamp>this.lastRecordedTimestamp)&&(this.lastRecordedTimestamp=e.timestamp),this.firstRecordedTimestamp&&e.timestamp<this.firstRecordedTimestamp)return void H.getInstance().postNoibuErrorAndOptionallyDisableClient("Detected time rewind. Client has been disabled.",!0,"error",!0);this.eventBuffer.push(Wn(e)),this.lastRRWebEvent=e,this.checkForCSSURLs(e),3!==e.type||2!==e.data.source||2!==e.data.type&&4!==e.data.type||W.getInstance().addVideoClick();const n=new Date;n.setMilliseconds(n.getMilliseconds()-500),(this.eventBuffer.length>=10||this.lastFragPostTimestamp<n)&&this.handleFragPost()}buildDebugMessage(e,t,n){let r="Posting metrics, logging due to large retry message queue";return r+=", URL: "+document.location.href,r+=", Session Length: "+n,r+=", Video Length: "+t,r+=", Length Delta: "+(t-n),r+=", Session Start: "+new Date(Q.getInstance().sessionTimestamp),null!==this.firstRecordedTimestamp&&(r+=", Video Start: "+new Date(this.firstRecordedTimestamp),r+=", Start Delta: "+(this.firstRecordedTimestamp-Q.getInstance().sessionTimestamp)),r+=", Last active time: "+H.getInstance().lastActiveTime,r+=", Visibility: "+document.visibilityState,this.pageStateHistory.length>0&&(r+=", Page States: "+this.pageStateHistory),r+=`, Socket: Connected ${Q.getInstance().isConnected()} Count ${Q.getInstance().connectionCount} Buffer: ${Q.getInstance().socket.bufferedAmount}`,Q.getInstance().socketCloseCodes.length>0&&(r+=" Closure Codes: "+Q.getInstance().socketCloseCodes),Q.getInstance().socketOpens.length>0&&(r+=" Opens: "+Q.getInstance().socketOpens),null!==this.lastRRWebEvent&&(r+=`, Last rrweb event: Type ${this.lastRRWebEvent.type} Data Source ${this.lastRRWebEvent.data&&void 0!==this.lastRRWebEvent.data.source?this.lastRRWebEvent.data.source:-1} Data Type ${this.lastRRWebEvent.data&&void 0!==this.lastRRWebEvent.data.type?this.lastRRWebEvent.data.type:-1} Time: ${new Date(this.lastRRWebEvent.timestamp)}`),Q.getInstance().retryMessageQueue.length>0&&(r+=", Retry queue length: "+Q.getInstance().retryMessageQueue.length),r+=`, Sequence Info: Latest ${this.lastFragPostTimestamp} ${Q.getInstance().messageSequenceNum} Ack'd ${Q.getInstance().latestReceivedSeqNumStoredTime} ${Q.getInstance().latestReceivedSeqNumber}`,e&&(r+=", Event: "+e),r}handleFragPost(){if(!Q.getInstance().closeIfInactive()&&this.didSetupRecorder&&0!==this.eventBuffer.length){try{let e=0;this.firstRecordedTimestamp&&this.lastRecordedTimestamp&&!this.invalidVideoLength&&(e=this.lastRecordedTimestamp-this.firstRecordedTimestamp),!this.invalidVideoLength&&(e<0||e>=Number.MAX_SAFE_INTEGER)&&(H.getInstance().postNoibuErrorAndOptionallyDisableClient(`video lengthMS is invalid: ${e}, start time: ${this.firstRecordedTimestamp}, end time: `+this.lastRecordedTimestamp,!1,"error"),this.invalidVideoLength=!0,e=0),this.vfCounter+=1;const t={};t.vid=M(this.eventBuffer),t.seq=this.vfCounter,t.len=e,t.css_urls=this.getCSSURLsNotReceived(),Q.getInstance().addEndTimeToPayload(t,!1),W.getInstance().addVideoFragData(this.vfCounter,e);const n={};n.pvvf=t,Q.getInstance().sendMessage("v",n),this.lastFragPostTimestamp=new Date}catch(e){H.getInstance().postNoibuErrorAndOptionallyDisableClient("video frag socket closed with err: "+e.message,!1,"error"),this.recordStopper&&this.recordStopper()}this.eventBuffer=[]}}unfreeze(){this.freezingEvents&&Kn("unfreeze",{})}}class qn{constructor(){this.customIDs={},this.customErrorsCount=0,this.TOO_MANY_IDS_ADDED_MSG="TOO_MANY_IDS_ADDED",this.ID_NAME_ALREADY_ADDED_MSG="ID_NAME_ALREADY_ADDED",this.NAME_TOO_LONG_MSG="NAME_TOO_LONG",this.VALUE_TOO_LONG_MSG="VALUE_TOO_LONG",this.INVALID_NAME_TYPE_MSG="INVALID_NAME_TYPE",this.INVALID_VALUE_TYPE_MSG="INVALID_VALUE_TYPE",this.NAME_HAS_NO_LENGTH_MSG="NAME_HAS_NO_LENGTH",this.VALUE_HAS_NO_LENGTH_MSG="VALUE_HAS_NO_LENGTH",this.SUCCESS_MSG="SUCCESS",this.ERROR_HAS_NO_MSG_MSG="ERROR_HAS_NO_MSG",this.ERROR_HAS_NO_STACK_MSG="ERROR_HAS_NO_STACK",this.NULL_CUSTOM_ERR_MSG="NULL_CUSTOM_ERROR",this.ERROR_ALREADY_RECEIVED_MSG="ERROR_ALREADY_RECEIVED",this.INVALID_ERROR_SOURCE_MSG="INVALID_ERROR_SOURCE_MSG",this.TOO_MANY_ERRORS_RECEIVED_PER_PAGEVISIT_MSG="TOO_MANY_ERRORS_RECEIVED_PER_PAGEVISIT"}static getInstance(){return this.instance||(this.instance=new qn),this.instance}exposeFunctions(){const e=this._getSDKWindowObject();window.NOIBUJS=e}_getSDKWindowObject(){return{addCustomAttribute:this._addCustomAttribute.bind(this),addError:this._addCustomError.bind(this),addJsSdkError:this._addErrorFromJSSdk.bind(this)}}_validateCustomError(e){return e?e.message?e.stack?this.SUCCESS_MSG:this.ERROR_HAS_NO_STACK_MSG:this.ERROR_HAS_NO_MSG_MSG:this.NULL_CUSTOM_ERR_MSG}_validateAndSetCustomError(e){if(this.customErrorsCount>=500)return this.TOO_MANY_ERRORS_RECEIVED_PER_PAGEVISIT_MSG;const t=this._validateCustomError(e);return t!==this.SUCCESS_MSG?t:(this.customErrorsCount+=1,this.SUCCESS_MSG)}_addErrorFromJSSdk(e,t){const n=this._validateAndSetCustomError(e);return n!==this.SUCCESS_MSG?n:"ReactError"!==t&&"VueError"!==t?this.INVALID_ERROR_SOURCE_MSG:(ee(t,{error:e}),n)}_addCustomError(e){const t=this._validateAndSetCustomError(e);return t!==this.SUCCESS_MSG||ee("CustomError",{error:e}),t}_addCustomAttribute(e,t){if(Object.keys(this.customIDs).length>=10)return this.TOO_MANY_IDS_ADDED_MSG;const n=this._validateCustomIDInput(e,t);return n!==this.SUCCESS_MSG?n:e in this.customIDs?this.ID_NAME_ALREADY_ADDED_MSG:(this.customIDs[e]=t,Q.getInstance().sendMessage("m",{pvm:{id_name:e,id_val:t}}),this.SUCCESS_MSG)}_validateCustomIDInput(e,t){return"string"!=typeof e?this.INVALID_NAME_TYPE_MSG:"string"!=typeof t?this.INVALID_VALUE_TYPE_MSG:t.length>50?this.VALUE_TOO_LONG_MSG:e.length>50?this.NAME_TOO_LONG_MSG:0===t.length?this.VALUE_HAS_NO_LENGTH_MSG:0===e.length?this.NAME_HAS_NO_LENGTH_MSG:this.SUCCESS_MSG}}!function(t){if(V())return;if(function(t){for(let n=0;n<e.length;n+=1){if(!t[e[n]])return!0}return!1}(t))return;if(!window.location.href.startsWith("http"))return;if(function(){const e=void 0!==window.noibuJSLoaded;return window.noibuJSLoaded=!0,e}())return;const n=t.metroplexHTTPBase+"/collect_error";H.configureInstance(n);try{const e=C()();if(H.getInstance().isClientDisabled)return;H.getInstance().setupBrowserIDCookie(),Q.getInstance(e),Yn.configureInstance(),J.configureInstance();const t=Yn.getInstance();K.getInstance();const n=new Ie,r=fe.getInstance(),i=ve.getInstance();se(),de(),le(),r.monitorClicks(),setInterval((function(){if(Ce!==window.location.href){Ce=window.location.href;const e={url:R()};j.getInstance().addEvent(e,"loc")}}),1e3),n.monitor(),i.monitor(),new Promise(e=>{function t(){"complete"===document.readyState&&(window.removeEventListener("load",t),document.removeEventListener("readystatechange",t),e())}"complete"===document.readyState?e():(window.addEventListener("load",t),document.addEventListener("readystatechange",t))}).then(()=>{t.recordUserSession()}),qn.getInstance().exposeFunctions()}catch(e){H.getInstance().postNoibuErrorAndOptionallyDisableClient(e,!0,"error")}}({metroplexSocketBase:g(),metroplexHTTPBase:p()})})()})();